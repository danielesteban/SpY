{"version":3,"sources":["webpack:///./src/engine/camera.js","webpack:///./src/engine/grid.js","webpack:///./src/materials/rain.js","webpack:///./src/engine/rain.js","webpack:///./src/engine/moon.js","webpack:///./src/engine/starfield.js","webpack:///./src/engine/vignette.js","webpack:///./src/engine/scene.js","webpack:///./src/engine/music.js","webpack:///./src/engine/input.js","webpack:///./src/items/bubble.js","webpack:///./src/engine/actor.js","webpack:///./src/actors/dude.js","webpack:///./src/items/marker.js","webpack:///./src/scenes/debug.js","webpack:///./src/building/elevator/cabin.js","webpack:///./src/items/button.js","webpack:///./src/building/elevator/doors.js","webpack:///./src/building/elevator/shaft.js","webpack:///./src/building/elevator/index.js","webpack:///./src/building/wall.js","webpack:///./src/building/hallway.js","webpack:///./src/engine/walkable.js","webpack:///./src/building/index.js","webpack:///./src/scenes/game.js","webpack:///./src/scenes/index.js","webpack:///./src/materials/grid.js","webpack:///./src/index.js","webpack:///./src/materials/sprite.js"],"names":["Camera","_this","_classCallCheck","this","_getPrototypeOf","call","distance","maxHeight","Infinity","offset","tilt","Math","PI","pitch","speed","step","Vector3","root","Object3D","add","_assertThisInitialized","updateOrbit","PerspectiveCamera","delta","_ref","position","target","distanceTo","copy","sub","normalize","multiplyScalar","movement","_ref2","secondary","wheel","hasUpdated","x","y","min","max","set","cos","sin","lookAt","Grid","arguments","length","undefined","_ref$background","background","Color","_ref$size","size","_ref$subdivisions","subdivisions","grid_classCallCheck","geometry","CircleBufferGeometry","translate","rotateX","grid_possibleConstructorReturn","grid_getPrototypeOf","GridMaterial","material","color","Mesh","RainMaterial","_ref$color","rest","_objectWithoutProperties","rain_classCallCheck","vertexShader","ShaderLib","basic","replace","join","rain_possibleConstructorReturn","rain_getPrototypeOf","_objectSpread","name","uniforms","UniformsUtils","clone","fragmentShader","fog","diffuse","value","ShaderMaterial","Rain","engine_rain_classCallCheck","drop","BufferGeometry","fromGeometry","BoxGeometry","attributes","array","offsets","Float32Array","numDrops","InstancedBufferGeometry","addAttribute","BufferAttribute","InstancedBufferAttribute","setDynamic","engine_rain_possibleConstructorReturn","engine_rain_getPrototypeOf","frustumCulled","i","resetDrop","height","testHeight","z","needsUpdate","random","radius","func","Moon","moon_classCallCheck","moon_possibleConstructorReturn","moon_getPrototypeOf","SphereBufferGeometry","MeshBasicMaterial","Starfield","starfield_classCallCheck","count","aux","floor","o","starfield_possibleConstructorReturn","starfield_getPrototypeOf","PointsMaterial","sizeAttenuation","moon","Points","Vignette","vignette_classCallCheck","vignette_possibleConstructorReturn","vignette_getPrototypeOf","camera","OrthographicCamera","sprite","SpriteMaterial","width","map","wrapS","ClampToEdgeWrapping","wrapT","magFilter","NearestFilter","minFilter","LinearFilter","Sprite","Scene","renderer","ctx","grd","createRadialGradient","addColorStop","fillStyle","beginPath","rect","fill","clearDepth","render","_ref$mount","mount","document","body","scene_classCallCheck","clock","Clock","WebGLRenderer","alpha","antialias","autoClear","setAnimationLoop","onAnimate","bind","setPixelRatio","window","devicePixelRatio","sky","setClearColor","appendChild","domElement","Root","FogExp2","AmbientLight","light","DirectionalLight","secondaryLight","grid","rain","starfield","vignette","addEventListener","onResize","ShaderChunk","fog_pars_vertex","fog_vertex","fog_pars_fragment","fog_fragment","stats","begin","animation","getDelta","time","oldTime","onAnimationTick","children","forEach","child","clear","end","_mount$getBoundingCli","getBoundingClientRect","setSize","aspect","updateProjectionMatrix","fixThreeJSFog","QuaternionKeyframeTrack","DefaultInterpolation","InterpolateSmooth","VectorKeyframeTrack","Music","toggle","script","createElement","async","defer","src","check","SC","api","initialize","client_id","tracks","shuffle","track","wantsToPlay","play","setTimeout","index","temp","_this2","player","kill","id","stream","concat","then","on","next","setVolume","catch","button","isPlaying","pause","className","Input","pointer","current","Vector2","normalized","last","raycaster","Raycaster","touches","Touches","preventSimulated","onPointerDown","onPointerMove","onPointerUp","addWheelListener","onPointerWheel","e","preventDefault","frame","primaryDown","primaryUp","secondaryDown","secondaryUp","isEnabled","primary","_ref4","_slicedToArray","_ref3","top","left","_touches$i","clientX","clientY","_ref5","deltaY","_ref6","Bubble","_possibleConstructorReturn","depthTest","scale","visible","lines","delay","_this$material","clearRect","textAlign","textBaseline","shadowColor","shadowBlur","font","fillText","shift","clearTimeout","timer","display","Actor","collisionGeometry","actor_classCallCheck","actor_getPrototypeOf","hip","Bone","torso","head","leftArm","rightArm","leftLeg","rightLeg","Skeleton","mixer","AnimationMixer","actor_assertThisInitialized","actions","Object","keys","animations","reduce","action","_defineProperty","clipAction","idle","timeScale","rotationAux","movementAux","collisionMesh","opacity","transparent","wireframe","SkinnedMesh","limbs","merged","Geometry","limb","faces","face","materialIndex","Bones","merge","vertices","a","bone","b","c","vertex","skinIndices","push","Vector4","skinWeights","computeVertexNormals","computeBoundingSphere","walkingSpeed","walk","destinationMarker","rotationSpeed","route","targetRotation","update","rotationStep","rotationDelta","rotation","abs","waypoint","path","faceTo","setAnimation","onDestinationCallback","fadeOut","reset","fadeIn","callback","point","angle","bubble","boundingSphere","eulerToQuat","Quaternion","setFromEuler","Euler","toArray","AnimationClip","_toConsumableArray","Dude","palette","dude_classCallCheck","bones","dude_assertThisInitialized","dude_getPrototypeOf","CylinderBufferGeometry","skeleton","CylinderGeometry","SphereGeometry","hat","leftEye","eyes","rightEye","arms","legs","geometryFromLimbs","center","MeshPhongMaterial","skinning","vertexColors","VertexColors","Marker","marker_classCallCheck","marker_possibleConstructorReturn","marker_getPrototypeOf","inc","s","debug","input","scene","pack","dudes","debug_toConsumableArray","Array","v","dude","getPointerFrame","processInput","setFromCamera","hit","intersectObject","walkTo","mainDudeX","mainDudeZ","mainDude","Cabin","cabin_classCallCheck","setHSL","splice","cabin_possibleConstructorReturn","cabin_getPrototypeOf","side","DoubleSide","Button","onTap","button_classCallCheck","BoxBufferGeometry","button_possibleConstructorReturn","button_getPrototypeOf","animationVector","origin","ret","tapping","ThreeMath","smoothstep","addScaledVector","Doors","onCall","doors_classCallCheck","doors_possibleConstructorReturn","doors_getPrototypeOf","plane","PlaneGeometry","door","animationScale","state","states","CLOSED","targetState","callButton","MOVING","OPEN","close","open","animationStep","Shaft","floors","shaft_classCallCheck","back","rotateY","shaft_possibleConstructorReturn","shaft_getPrototypeOf","Elevator","elevator_classCallCheck","elevator_possibleConstructorReturn","elevator_getPrototypeOf","animationStart","shaft","doors","elevator_toConsumableArray","cabin","to","travel","from","Wall","_ref2$aoTop","aoTop","_ref2$aoBottom","aoBottom","wall_classCallCheck","getGeometry","orientation","wall_possibleConstructorReturn","wall_getPrototypeOf","_ref$aoTop","_ref$aoBottom","_ref$width","_ref$height","wall","ceil","wall_toConsumableArray","j","offsetHSL","Hallway","hasCeiling","hasElevator","isEdge","isLobby","hallway_classCallCheck","hallway_possibleConstructorReturn","hallway_getPrototypeOf","Walkable","walkable_classCallCheck","intersect","walkable_possibleConstructorReturn","walkable_getPrototypeOf","finder","AStarFinder","allowDiagonal","dontCrossCorners","setWalkableAt","worldToGrid","findPath","walkable_slicedToArray","localToWorld","worldToLocal","isWalkableAt","Building","elevators","building_classCallCheck","building_possibleConstructorReturn","building_getPrototypeOf","elevator","layout","split","heightmap","building_toConsumableArray","buttons","rooms","type","room","mesh","indexOf","elevatorIndex","findIndex","walkable","game","building","reverse","setHeightTest","getHeight","game_toConsumableArray","spawn","addToFloorGrid","game_objectSpread","intersectObjects","object","parent","onDestination","say","getPath","slice","tap","__webpack_require__","d","__webpack_exports__","phong","primaryGrid","secondaryGrid","extensions","derivatives","lights","r","setImmediate","fonts","loaded","_engine_input__WEBPACK_IMPORTED_MODULE_0__","_engine_music__WEBPACK_IMPORTED_MODULE_1__","_engine_scene__WEBPACK_IMPORTED_MODULE_2__","_scenes__WEBPACK_IMPORTED_MODULE_3__","getElementById","music","location","hash","Scenes","reload","test","fontTester","innerText","style","fontFamily","initialWidth","removeChild","once","texture","CanvasTexture","getContext","ThreeSprite"],"mappings":"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","file":"code/main.5d201ff81374c1da2ff7.js","sourcesContent":["import {\n  Object3D,\n  PerspectiveCamera,\n  Vector3,\n} from 'three';\n\nclass Camera extends PerspectiveCamera {\n  constructor() {\n    super(60, 1, 0.1, 2048);\n    this.distance = 5;\n    this.maxHeight = Infinity;\n    this.offset = 1.2;\n    this.tilt = Math.PI * -0.45;\n    this.pitch = Math.PI * 0.1;\n    this.speed = 1.25;\n    this.step = new Vector3();\n    this.root = new Object3D();\n    this.root.add(this);\n    this.updateOrbit();\n  }\n\n  onAnimationTick({ delta }) {\n    const {\n      root: { position },\n      speed,\n      step,\n      target,\n    } = this;\n    if (!target || position.distanceTo(target) <= 0.1) return;\n    step\n      .copy(target)\n      .sub(position)\n      .normalize()\n      .multiplyScalar(delta * speed);\n    position.add(step);\n  }\n\n  processInput({\n    movement,\n    secondary,\n    wheel,\n  }) {\n    let hasUpdated = false;\n    if (secondary) {\n      const sensitivity = 0.003;\n      this.tilt -= movement.x * sensitivity;\n      this.pitch += movement.y * sensitivity;\n      this.pitch = Math.min(Math.max(this.pitch, Math.PI * -0.45), Math.PI * 0.45);\n      hasUpdated = true;\n    }\n    if (wheel) {\n      const sensitivity = 0.006;\n      this.distance = Math.min(Math.max(this.distance + (wheel * sensitivity), 1), 16);\n      hasUpdated = true;\n    }\n    if (hasUpdated) this.updateOrbit();\n    return hasUpdated;\n  }\n\n  updateOrbit() {\n    const {\n      distance,\n      maxHeight,\n      offset,\n      pitch,\n      position,\n      root,\n      tilt,\n    } = this;\n    position.set(\n      Math.cos(tilt) * Math.cos(pitch),\n      Math.sin(pitch),\n      Math.sin(-tilt) * Math.cos(pitch)\n    )\n      .normalize()\n      .multiplyScalar(distance);\n    position.y = Math.min(Math.max(position.y, 0.1 - offset), maxHeight - offset);\n    this.lookAt(root.position);\n    position.y += offset;\n  }\n}\n\nexport default Camera;\n","import {\n  Color,\n  Mesh,\n  CircleBufferGeometry,\n} from 'three';\nimport GridMaterial from '@/materials/grid';\n\nclass Grid extends Mesh {\n  constructor({\n    background = new Color(0xFFFFFF),\n    size = 1,\n    subdivisions = 10,\n  } = {}) {\n    const geometry = new CircleBufferGeometry(128, 8);\n    geometry.translate(0, 0, -0.01);\n    geometry.rotateX(Math.PI * -0.5);\n    super(\n      geometry,\n      new GridMaterial({\n        size,\n        subdivisions,\n      })\n    );\n    this.material.color.set(background);\n  }\n}\n\nexport default Grid;\n","import {\n  ShaderLib,\n  ShaderMaterial,\n  UniformsUtils,\n} from 'three';\n\nclass RainMaterial extends ShaderMaterial {\n  constructor({\n    color = 0xFFFFFF,\n    ...rest\n  } = {}) {\n    const vertexShader = ShaderLib.basic.vertexShader.replace(\n      '#include <clipping_planes_pars_vertex>',\n      [\n        '#include <clipping_planes_pars_vertex>',\n        'attribute vec3 offset;',\n      ].join('\\n')\n    ).replace(\n      '#include <begin_vertex>',\n      [\n        'vec3 transformed = vec3(position + offset);',\n      ].join('\\n')\n    );\n    super({\n      name: 'rain-material',\n      uniforms: UniformsUtils.clone(ShaderLib.basic.uniforms),\n      fragmentShader: ShaderLib.basic.fragmentShader,\n      vertexShader,\n      fog: true,\n      ...rest,\n    });\n    this.color = this.uniforms.diffuse.value;\n    this.color.set(color);\n  }\n}\n\nexport default RainMaterial;\n","import {\n  BufferAttribute,\n  BoxGeometry,\n  BufferGeometry,\n  InstancedBufferGeometry,\n  InstancedBufferAttribute,\n  Mesh,\n  Vector3,\n} from 'three';\nimport RainMaterial from '@/materials/rain';\n\nclass Rain extends Mesh {\n  constructor() {\n    const drop = (new BufferGeometry()).fromGeometry(\n      (new BoxGeometry(0.01, 0.5, 0.01)).translate(0, 0.25, 0)\n    ).attributes.position.array;\n    const offsets = new Float32Array(Rain.numDrops * 3);\n    const geometry = new InstancedBufferGeometry();\n    geometry.addAttribute('position', new BufferAttribute(drop, 3));\n    geometry.addAttribute('offset', (new InstancedBufferAttribute(offsets, 3).setDynamic(true)));\n    super(\n      geometry,\n      new RainMaterial({\n        color: 0xAAAADD,\n      })\n    );\n    this.frustumCulled = false;\n    this.drop = new Vector3();\n    this.offsets = offsets;\n    for (let i = 0; i < Rain.numDrops * 3; i += 3) {\n      this.resetDrop(i);\n    }\n  }\n\n  onAnimationTick({ delta }) {\n    const { geometry, offsets, position } = this;\n    const step = delta * 16;\n    for (let i = 0; i < Rain.numDrops * 3; i += 3) {\n      offsets[i + 1] -= step;\n      let height = 0;\n      if (this.testHeight) {\n        height = this.testHeight(offsets[i] + position.x, offsets[i + 2] + position.z);\n      }\n      if (offsets[i + 1] <= height) {\n        this.resetDrop(i);\n      }\n    }\n    geometry.attributes.offset.needsUpdate = true;\n  }\n\n  resetDrop(i) {\n    const { drop, offsets, position } = this;\n    drop.set(\n      (Math.random() * (Rain.radius * 2 + 1)) - Rain.radius,\n      0,\n      (Math.random() * (Rain.radius * 2 + 1)) - Rain.radius\n    );\n    let height = Math.random() * Rain.radius * 0.5;\n    if (this.testHeight) {\n      height = Math.max(height, this.testHeight(drop.x + position.x, drop.z + position.z));\n    }\n    offsets[i] = drop.x;\n    offsets[i + 1] = height;\n    offsets[i + 2] = drop.z;\n  }\n\n  setHeightTest(func) {\n    const { geometry } = this;\n    this.testHeight = func;\n    for (let i = 0; i < Rain.numDrops * 3; i += 3) {\n      this.resetDrop(i);\n    }\n    geometry.attributes.offset.needsUpdate = true;\n  }\n}\n\nRain.numDrops = 10000;\nRain.radius = 50;\n\nexport default Rain;\n","import {\n  Mesh,\n  MeshBasicMaterial,\n  SphereBufferGeometry,\n} from 'three';\n\nclass Moon extends Mesh {\n  constructor() {\n    super(\n      new SphereBufferGeometry(100, 32, 32),\n      new MeshBasicMaterial({\n        color: 0xAAAAAA,\n        fog: false,\n      })\n    );\n  }\n}\n\nexport default Moon;\n","import {\n  BufferAttribute,\n  BufferGeometry,\n  Points,\n  PointsMaterial,\n  Vector3,\n} from 'three';\nimport Moon from './moon';\n\nclass Starfield extends Points {\n  constructor() {\n    const count = 10000;\n    const radius = 1024;\n    const geometry = new BufferGeometry();\n    const position = new Float32Array(count * 3);\n    const size = new Float32Array(count);\n    const aux = new Vector3();\n    for (let i = 0; i < count; i += 1) {\n      aux.set(\n        Math.floor(Math.random() * ((radius * 2) + 1)) - radius,\n        Math.floor(Math.random() * (radius + 1)),\n        Math.floor(Math.random() * ((radius * 2) + 1)) - radius\n      ).normalize().multiplyScalar(radius);\n      const o = i * 3;\n      position[o] = aux.x;\n      position[o + 1] = aux.y;\n      position[o + 2] = aux.z;\n      size[i] = 10 + Math.floor(Math.random() * 100);\n    }\n    geometry.addAttribute('position', new BufferAttribute(position, 3));\n    geometry.addAttribute('size', new BufferAttribute(size, 1));\n    super(\n      geometry,\n      new PointsMaterial({\n        color: 0x999999,\n        fog: false,\n        sizeAttenuation: false,\n      })\n    );\n    this.moon = new Moon();\n    this.moon.position.set(radius, radius * 0.5, radius);\n    this.add(this.moon);\n  }\n}\n\nexport default Starfield;\n","import {\n  ClampToEdgeWrapping,\n  NearestFilter,\n  LinearFilter,\n  Sprite,\n  Scene,\n  OrthographicCamera,\n} from 'three';\nimport SpriteMaterial from '@/materials/sprite';\n\n\nclass Vignette extends Scene {\n  constructor() {\n    super();\n    this.camera = new OrthographicCamera(-0.5, 0.5, 0.5, -0.5, 0, 1);\n    this.sprite = new SpriteMaterial({\n      width: 0,\n      height: 0,\n    });\n    this.sprite.map.wrapS = ClampToEdgeWrapping;\n    this.sprite.map.wrapT = ClampToEdgeWrapping;\n    this.sprite.map.magFilter = NearestFilter;\n    this.sprite.map.minFilter = LinearFilter;\n    this.add(new Sprite(this.sprite));\n  }\n\n  onResize({ width, height }) {\n    const { sprite } = this;\n    const { renderer, ctx } = sprite;\n    const size = Math.max(width, height);\n    renderer.width = size;\n    renderer.height = size;\n    const grd = ctx.createRadialGradient(\n      size * 0.5, size * 0.5, size * 0.6,\n      size * 0.5, size * 0.5, size\n    );\n    grd.addColorStop(0, 'rgba(0, 0, 0, 0)');\n    grd.addColorStop(1, 'rgba(0, 0, 0, 1)');\n    ctx.fillStyle = grd;\n    ctx.beginPath();\n    ctx.rect(0, 0, size, size);\n    ctx.fill();\n    sprite.map.needsUpdate = true;\n  }\n\n  render(renderer) {\n    renderer.clearDepth();\n    renderer.render(this, this.camera);\n  }\n}\n\nexport default Vignette;\n","import Stats from 'stats.js';\nimport {\n  AmbientLight,\n  Clock,\n  Color,\n  DirectionalLight,\n  FogExp2,\n  InterpolateSmooth,\n  QuaternionKeyframeTrack,\n  Scene as Root,\n  ShaderChunk,\n  VectorKeyframeTrack,\n  WebGLRenderer,\n} from 'three';\nimport Camera from './camera';\nimport Grid from './grid';\nimport Rain from './rain';\nimport Starfield from './starfield';\nimport Vignette from './vignette';\n\nclass Scene {\n  constructor({\n    mount = document.body,\n  } = {}) {\n    this.camera = new Camera();\n    this.clock = new Clock();\n    this.mount = mount;\n    this.renderer = new WebGLRenderer({\n      alpha: false,\n      antialias: true,\n    });\n    this.renderer.autoClear = false;\n    this.renderer.setAnimationLoop(this.onAnimate.bind(this));\n    this.renderer.setPixelRatio(window.devicePixelRatio || 1);\n    const sky = new Color(0x334455);\n    this.renderer.setClearColor(sky);\n    mount.appendChild(this.renderer.domElement);\n    this.root = new Root();\n    this.root.fog = new FogExp2(sky, 0.03);\n    this.root.add(new AmbientLight(0x333333));\n    const light = new DirectionalLight(0xffffff, 0.6);\n    light.position.set(1, 0.5, 1);\n    this.root.add(light);\n    const secondaryLight = new DirectionalLight(0xffffff, 0.4);\n    secondaryLight.position.set(-1, -0.5, 1);\n    this.root.add(secondaryLight);\n    this.root.add(this.camera.root);\n    this.grid = new Grid({ background: new Color(0x333344) });\n    this.root.add(this.grid);\n    this.rain = new Rain();\n    this.root.add(this.rain);\n    this.starfield = new Starfield();\n    this.root.add(this.starfield);\n    this.vignette = new Vignette();\n    window.addEventListener('resize', this.onResize.bind(this), false);\n    this.onResize();\n    if (!__PRODUCTION__) {\n      this.stats = new Stats();\n      this.stats.dom.style.position = 'absolute';\n      this.stats.dom.style.top = 'auto';\n      this.stats.dom.style.left = 'auto';\n      this.stats.dom.style.bottom = '0';\n      this.stats.dom.style.right = '0';\n      mount.style.position = 'relative';\n      mount.appendChild(this.stats.dom);\n    }\n  }\n\n  onAnimate() {\n    const {\n      clock,\n      camera,\n      grid,\n      renderer,\n      root,\n      starfield,\n      stats,\n      vignette,\n    } = this;\n    if (stats) stats.begin();\n    const animation = { delta: Math.min(clock.getDelta(), 1), time: clock.oldTime / 1000 };\n    if (this.onAnimationTick) {\n      this.onAnimationTick(animation);\n    }\n    root.children.forEach((child) => {\n      if (child.onAnimationTick) {\n        child.onAnimationTick(animation);\n      }\n    });\n    if (camera.onAnimationTick) {\n      camera.onAnimationTick(animation);\n    }\n    grid.position.set(camera.root.position.x, 0, camera.root.position.z);\n    starfield.position.copy(grid.position);\n    renderer.clear();\n    renderer.render(root, camera);\n    vignette.render(renderer);\n    if (stats) stats.end();\n  }\n\n  onResize() {\n    const {\n      camera,\n      mount,\n      renderer,\n      vignette,\n    } = this;\n    const { width, height } = mount.getBoundingClientRect();\n    renderer.setSize(width, height);\n    camera.aspect = width / height;\n    camera.updateProjectionMatrix();\n    vignette.onResize({ width, height });\n  }\n\n  static fixThreeJSFog() {\n    ShaderChunk.fog_pars_vertex = ShaderChunk.fog_pars_vertex.replace(\n      'varying float fogDepth;',\n      'varying vec4 fogDepth;'\n    );\n    ShaderChunk.fog_vertex = ShaderChunk.fog_vertex.replace(\n      'fogDepth = -mvPosition.z;',\n      'fogDepth = mvPosition;'\n    );\n    ShaderChunk.fog_pars_fragment = ShaderChunk.fog_pars_fragment.replace(\n      'varying float fogDepth;',\n      'varying vec4 fogDepth;'\n    );\n    ShaderChunk.fog_fragment = ShaderChunk.fog_fragment.replace(\n      'float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );',\n      [\n        'float fogDist = length(fogDepth);',\n        'float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDist * fogDist * LOG2 ) );',\n      ].join('\\n')\n    ).replace(\n      'float fogFactor = smoothstep( fogNear, fogFar, fogDepth );',\n      'float fogFactor = smoothstep( fogNear, fogFar, length(fogDepth) );'\n    );\n  }\n}\n\nScene.fixThreeJSFog();\nQuaternionKeyframeTrack.DefaultInterpolation = InterpolateSmooth;\nVectorKeyframeTrack.DefaultInterpolation = InterpolateSmooth;\n\nexport default Scene;\n","class Music {\n  static shuffle(tracks) {\n    for (let index = tracks.length - 1; index >= 0; index -= 1) {\n      const random = Math.floor(Math.random() * tracks.length);\n      const temp = tracks[index];\n      tracks[index] = tracks[random];\n      tracks[random] = temp;\n    }\n    return tracks;\n  }\n\n  constructor({ toggle }) {\n    const loaded = () => {\n      this.api = window.SC;\n      this.api.initialize({\n        client_id: 'eb5fcff9e107aab508431b4c3c416415',\n      });\n      // this.api.resolve('https://soundcloud.com/travis-stanley-3/sets/jazz-noir-dark-jazz').then(({ tracks }) => {\n      //   console.log(JSON.stringify(tracks.map(({ id }) => (id))));\n      // });\n      // eslint-disable-next-line\n      this.tracks = Music.shuffle([14281750,135099881,14449372,201545618,130450594,43516158,20969172,29561041,6582510,89379153,96594845,199889475,137188503,74658085,90256034,183847047,3916883]);\n      this.track = 0;\n      toggle.addEventListener('click', () => this.toggle(toggle), false);\n      if (this.wantsToPlay) {\n        delete this.wantsToPlay;\n        this.play();\n      }\n    };\n    const check = () => {\n      if (!window.SC) {\n        setTimeout(check, 10);\n        return;\n      }\n      loaded();\n    };\n    const script = document.createElement('script');\n    script.async = true;\n    script.defer = true;\n    script.src = 'https://connect.soundcloud.com/sdk/sdk-3.3.1.js';\n    document.body.appendChild(script);\n    check();\n  }\n\n  next() {\n    this.track = (this.track + 1) % this.tracks.length;\n    this.play();\n  }\n\n  play() {\n    const {\n      api,\n      player,\n      track,\n      tracks,\n    } = this;\n    if (!api) {\n      this.wantsToPlay = true;\n      return;\n    }\n    if (player) {\n      player.kill();\n      delete this.player;\n    }\n    const id = tracks[track];\n    if (!__PRODUCTION__) console.log(`playing: ${id}`);\n    api.stream(`/tracks/${id}`).then((player) => {\n      this.player = player;\n      player.on('audio_error', () => this.next());\n      player.on('finish', () => this.next());\n      player.setVolume(0.8);\n      player.play();\n    }).catch(() => {\n      this.next();\n    });\n  }\n\n  toggle(button) {\n    const { player } = this;\n    if (!player) return;\n    if (player.isPlaying()) {\n      player.pause();\n      button.className = 'muted';\n    } else {\n      button.className = '';\n      player.play();\n    }\n  }\n}\n\nexport default Music;\n","import { Raycaster, Vector2 } from 'three';\nimport Touches from 'touches';\nimport { addWheelListener } from 'wheel';\n\nclass Input {\n  constructor({\n    mount = document.body,\n  }) {\n    this.mount = mount;\n    this.pointer = {\n      current: new Vector2(0, 0),\n      movement: { x: 0, y: 0 },\n      normalized: new Vector2(0, 0),\n      last: new Vector2(0, 0),\n      raycaster: new Raycaster(),\n      wheel: 0,\n    };\n    this.touches = Touches(window, {\n      preventSimulated: false,\n      target: mount,\n    })\n      .on('start', this.onPointerDown.bind(this))\n      .on('move', this.onPointerMove.bind(this))\n      .on('end', this.onPointerUp.bind(this));\n    addWheelListener(window, this.onPointerWheel.bind(this));\n    window.addEventListener('contextmenu', e => e.preventDefault(), false);\n    window.addEventListener('resize', this.onResize.bind(this), false);\n    this.onResize();\n  }\n\n  getPointerFrame() {\n    const { pointer } = this;\n    const frame = { ...pointer };\n    pointer.primaryDown = false;\n    pointer.primaryUp = false;\n    pointer.secondaryDown = false;\n    pointer.secondaryUp = false;\n    pointer.movement = { x: 0, y: 0 };\n    pointer.wheel = 0;\n    return frame;\n  }\n\n  onPointerDown(e) {\n    const { isEnabled, pointer } = this;\n    if (!isEnabled) return;\n    const { button, touches } = e;\n    if (touches) {\n      if (touches.length > 1) {\n        e.preventDefault();\n      }\n      if (!pointer.secondary) {\n        if (touches.length === 1) {\n          pointer.primary = true;\n          pointer.primaryDown = true;\n        } else {\n          pointer.secondary = true;\n          pointer.secondaryDown = true;\n          pointer.primary = false;\n        }\n      }\n      return;\n    }\n    switch (button) {\n      case 0:\n        pointer.primary = true;\n        pointer.primaryDown = true;\n        break;\n      case 2:\n        pointer.secondary = true;\n        pointer.secondaryDown = true;\n        break;\n      default:\n    }\n  }\n\n  onPointerMove({ touches }, [x, y]) {\n    const { isEnabled, pointer, rect } = this;\n    if (!isEnabled) return;\n    if (touches) {\n      const { top, left } = rect;\n      x = 0;\n      y = 0;\n      for (let i = 0; i < touches.length; i += 1) {\n        const { clientX, clientY } = touches[i];\n        x += (clientX - left);\n        y += (clientY - top);\n      }\n      x /= touches.length;\n      y /= touches.length;\n    }\n    const { width, height } = rect;\n    pointer.current.x = x;\n    pointer.current.y = y;\n    pointer.normalized.x = ((x / width) * 2) - 1;\n    pointer.normalized.y = 1 - ((y / height) * 2);\n    pointer.movement = {\n      x: pointer.current.x - pointer.last.x,\n      y: pointer.current.y - pointer.last.y,\n    };\n    pointer.last.copy(pointer.current);\n  }\n\n  onPointerUp({ button, touches }) {\n    const { isEnabled, pointer } = this;\n    if (!isEnabled) return;\n    if (touches) {\n      if (pointer.primary) {\n        pointer.primary = false;\n        pointer.primaryUp = true;\n      }\n      if (pointer.secondary) {\n        pointer.secondary = false;\n        pointer.secondaryUp = true;\n      }\n      return;\n    }\n    switch (button) {\n      case 0:\n        pointer.primary = false;\n        pointer.primaryUp = true;\n        break;\n      case 2:\n        pointer.secondary = false;\n        pointer.secondaryUp = true;\n        break;\n      default:\n    }\n  }\n\n  onPointerWheel({ deltaY }) {\n    const { isEnabled, pointer } = this;\n    if (!isEnabled) return;\n    pointer.wheel = deltaY;\n  }\n\n  onResize() {\n    const { mount } = this;\n    this.rect = mount.getBoundingClientRect();\n  }\n}\n\n\nexport default Input;\n","import {\n  Sprite,\n} from 'three';\nimport SpriteMaterial from '@/materials/sprite';\n\nclass Bubble extends Sprite {\n  constructor() {\n    super(new SpriteMaterial({\n      width: 512,\n      height: 64,\n      depthTest: false,\n    }));\n    this.scale.set(2, 0.25, 1);\n    this.visible = false;\n  }\n\n  display(lines, delay = 1500) {\n    const { renderer, ctx } = this.material;\n    const { width, height } = renderer;\n    ctx.clearRect(0, 0, width, height);\n    ctx.fillStyle = '#fff';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';\n    ctx.shadowBlur = 10;\n    ctx.font = \"24px 'Print Char 21',monospace\";\n    ctx.fillText(lines.shift(), width * 0.5, height * 0.5);\n    this.material.map.needsUpdate = true;\n    this.visible = true;\n    clearTimeout(this.timer);\n    this.timer = setTimeout(() => {\n      if (lines.length) {\n        this.display(lines, delay);\n        return;\n      }\n      this.visible = false;\n    }, delay);\n  }\n}\n\nexport default Bubble;\n","import {\n  AnimationClip,\n  AnimationMixer,\n  Bone,\n  BufferGeometry,\n  Euler,\n  Geometry,\n  Mesh,\n  MeshBasicMaterial,\n  QuaternionKeyframeTrack,\n  Quaternion,\n  SkinnedMesh,\n  Skeleton,\n  Vector2,\n  Vector3,\n  Vector4,\n} from 'three';\nimport Bubble from '@/items/bubble';\n\nclass Actor extends SkinnedMesh {\n  static geometryFromLimbs(limbs) {\n    const merged = new Geometry();\n    Object.keys(limbs).forEach((limb) => {\n      limbs[limb].faces.forEach((face) => {\n        face.materialIndex = Actor.Bones[limb];\n      });\n      merged.merge(limbs[limb]);\n    });\n    merged.faces.forEach((face) => {\n      merged.vertices[face.a].bone = face.materialIndex;\n      merged.vertices[face.b].bone = face.materialIndex;\n      merged.vertices[face.c].bone = face.materialIndex;\n      face.materialIndex = 0;\n    });\n    merged.vertices.forEach((vertex) => {\n      merged.skinIndices.push(new Vector4(vertex.bone, 0, 0, 0));\n      merged.skinWeights.push(new Vector4(1, 0, 0, 0));\n    });\n    const geometry = (new BufferGeometry()).fromGeometry(merged);\n    geometry.computeVertexNormals();\n    geometry.computeBoundingSphere();\n    return geometry;\n  }\n\n  constructor({\n    collisionGeometry,\n    geometry,\n    material,\n  }) {\n    super(\n      geometry,\n      material\n    );\n    const hip = new Bone();\n    this.add(hip);\n    const torso = new Bone();\n    hip.add(torso);\n    const head = new Bone();\n    torso.add(head);\n    const leftArm = new Bone();\n    torso.add(leftArm);\n    const rightArm = new Bone();\n    torso.add(rightArm);\n    const leftLeg = new Bone();\n    hip.add(leftLeg);\n    const rightLeg = new Bone();\n    hip.add(rightLeg);\n    this.bind(new Skeleton([\n      hip,\n      torso,\n      head,\n      leftArm,\n      rightArm,\n      leftLeg,\n      rightLeg,\n    ]));\n    this.mixer = new AnimationMixer(this);\n    this.actions = Object.keys(Actor.animations).reduce((actions, action) => ({\n      ...actions,\n      [action]: this.mixer.clipAction(Actor.animations[action]),\n    }), {});\n    this.animation = 'idle';\n    this.actions.idle.timeScale = 0.5;\n    this.actions.idle.play();\n    this.rotationAux = new Vector2();\n    this.movementAux = new Vector3();\n    this.collisionMesh = new Mesh(\n      collisionGeometry,\n      new MeshBasicMaterial({\n        opacity: 0.1,\n        transparent: true,\n        visible: false,\n        wireframe: true,\n      })\n    );\n    this.add(this.collisionMesh);\n  }\n\n  onAnimationTick({ delta }) {\n    const {\n      actions: { walk: { timeScale: walkingSpeed } },\n      destinationMarker,\n      mixer,\n      movementAux,\n      position,\n      rotationSpeed,\n      route,\n      targetRotation,\n    } = this;\n    mixer.update(delta);\n    if (targetRotation !== undefined) {\n      const rotationStep = delta * rotationSpeed;\n      const rotationDelta = targetRotation - this.rotation.y;\n      this.rotation.y += Math.min(\n        Math.max(\n          rotationDelta,\n          -rotationStep\n        ),\n        rotationStep\n      );\n      if (Math.abs(rotationDelta) <= rotationStep) {\n        delete this.targetRotation;\n      }\n    }\n    if (!route) return;\n    const waypoint = route.path[route.current];\n    const distance = position.distanceTo(waypoint);\n    const step = delta * 1.5 * walkingSpeed;\n    position.add(\n      movementAux\n        .copy(waypoint)\n        .sub(position)\n        .normalize()\n        .multiplyScalar(Math.min(distance, step))\n    );\n    if (distance > step) {\n      return;\n    }\n    if (route.current < route.path.length - 1) {\n      route.current += 1;\n      this.faceTo(route.path[route.current]);\n      return;\n    }\n    this.setAnimation('idle');\n    delete this.route;\n    if (destinationMarker) {\n      destinationMarker.visible = false;\n    }\n    if (this.onDestinationCallback) {\n      this.onDestinationCallback();\n      delete this.onDestinationCallback;\n    }\n  }\n\n  setAnimation(animation) {\n    const { actions } = this;\n    if (this.animation === animation) return;\n    actions[this.animation].fadeOut(0.2);\n    this.animation = animation;\n    actions[this.animation]\n      .reset()\n      .fadeIn(0.2)\n      .play();\n  }\n\n  walk(path, callback) {\n    const { destinationMarker, position } = this;\n    const distance = position.distanceTo(path[path.length - 1]);\n    delete this.onDestinationCallback;\n    if (distance === 0) {\n      if (callback) callback();\n      return;\n    }\n    this.setAnimation('walk');\n    this.route = {\n      current: 0,\n      path,\n    };\n    if (destinationMarker) {\n      destinationMarker.position.copy(path[path.length - 1]);\n      destinationMarker.visible = true;\n    }\n    if (callback) {\n      this.onDestinationCallback = callback;\n    }\n    this.faceTo(path[0]);\n  }\n\n  faceTo(point) {\n    const { position, rotationAux } = this;\n    const angle = rotationAux.set(point.x - position.x, point.z - position.z).angle();\n    while (this.rotation.y < -Math.PI) this.rotation.y += Math.PI * 2;\n    while (this.rotation.y > Math.PI) this.rotation.y -= Math.PI * 2;\n    this.targetRotation = (Math.PI * 0.5) - angle;\n    while (this.targetRotation < -Math.PI) this.targetRotation += Math.PI * 2;\n    while (this.targetRotation > Math.PI) this.targetRotation -= Math.PI * 2;\n    if ((this.targetRotation - this.rotation.y) > Math.PI) {\n      this.targetRotation -= Math.PI * 2;\n    } else if ((this.targetRotation - this.rotation.y) < -Math.PI) {\n      this.targetRotation += Math.PI * 2;\n    }\n    this.rotationSpeed = Math.abs(this.targetRotation - this.rotation.y) * 1.5;\n  }\n\n  say(lines, delay) {\n    if (!this.bubble) {\n      this.bubble = new Bubble();\n      this.bubble.position.set(0, this.geometry.boundingSphere.radius * 2.25, 0);\n      this.add(this.bubble);\n    }\n    const { bubble } = this;\n    bubble.display(lines, delay);\n  }\n}\n\nActor.Bones = {\n  hip: 0,\n  torso: 1,\n  head: 2,\n  leftArm: 3,\n  rightArm: 4,\n  leftLeg: 5,\n  rightLeg: 6,\n};\n\nconst eulerToQuat = (x, y, z) => (new Quaternion()).setFromEuler(new Euler(x, y, z)).toArray();\n\nActor.animations = {\n  idle: (\n    new AnimationClip('idle', 1, [\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.torso}].quaternion`,\n        new Float32Array([\n          0,\n          0.5,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(0, Math.PI * -0.05, 0),\n          ...eulerToQuat(0, Math.PI * 0.05, 0),\n          ...eulerToQuat(0, Math.PI * -0.05, 0),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.head}].quaternion`,\n        new Float32Array([\n          0,\n          0.75,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(Math.PI * -0.075, 0, Math.PI * -0.025),\n          ...eulerToQuat(Math.PI * -0.075, 0, Math.PI * 0.025),\n          ...eulerToQuat(Math.PI * -0.075, 0, Math.PI * -0.025),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.leftArm}].quaternion`,\n        new Float32Array([\n          0,\n          0.75,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(0, 0, Math.PI * -0.05),\n          ...eulerToQuat(0, 0, Math.PI * -0.1),\n          ...eulerToQuat(0, 0, Math.PI * -0.05),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.rightArm}].quaternion`,\n        new Float32Array([\n          0,\n          0.25,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(0, 0, Math.PI * 0.05),\n          ...eulerToQuat(0, 0, Math.PI * 0.1),\n          ...eulerToQuat(0, 0, Math.PI * 0.05),\n        ])\n      ),\n    ])\n  ),\n  walk: (\n    new AnimationClip('walk', 1, [\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.torso}].quaternion`,\n        new Float32Array([\n          0,\n          0.5,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(Math.PI * -0.02, 0, Math.PI * 0.01),\n          ...eulerToQuat(Math.PI * 0.02, 0, Math.PI * -0.01),\n          ...eulerToQuat(Math.PI * -0.02, 0, Math.PI * 0.01),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.head}].quaternion`,\n        new Float32Array([\n          0,\n          0.5,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(0, 0, Math.PI * -0.025),\n          ...eulerToQuat(0, 0, Math.PI * 0.025),\n          ...eulerToQuat(0, 0, Math.PI * -0.025),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.leftArm}].quaternion`,\n        new Float32Array([\n          0,\n          0.5,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(Math.PI * 0.1, 0, 0),\n          ...eulerToQuat(Math.PI * -0.1, 0, Math.PI * -0.1),\n          ...eulerToQuat(Math.PI * 0.1, 0, 0),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.rightArm}].quaternion`,\n        new Float32Array([\n          0,\n          0.5,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(Math.PI * -0.1, 0, Math.PI * 0.1),\n          ...eulerToQuat(Math.PI * 0.1, 0, 0),\n          ...eulerToQuat(Math.PI * -0.1, 0, Math.PI * 0.1),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.leftLeg}].quaternion`,\n        new Float32Array([\n          0,\n          0.5,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(Math.PI * -0.15, 0, Math.PI * 0.01),\n          ...eulerToQuat(Math.PI * 0.15, 0, Math.PI * -0.01),\n          ...eulerToQuat(Math.PI * -0.15, 0, Math.PI * 0.01),\n        ])\n      ),\n      new QuaternionKeyframeTrack(\n        `.bones[${Actor.Bones.rightLeg}].quaternion`,\n        new Float32Array([\n          0,\n          0.5,\n          1,\n        ]),\n        new Float32Array([\n          ...eulerToQuat(Math.PI * 0.15, 0, Math.PI * -0.01),\n          ...eulerToQuat(Math.PI * -0.15, 0, Math.PI * 0.01),\n          ...eulerToQuat(Math.PI * 0.15, 0, Math.PI * -0.01),\n        ])\n      ),\n    ])\n  ),\n};\n\nexport default Actor;\n","import {\n  CylinderGeometry,\n  CylinderBufferGeometry,\n  MeshPhongMaterial,\n  SphereGeometry,\n  Vector3,\n  VertexColors,\n} from 'three';\nimport Actor from '@/engine/actor';\n\nclass Dude extends Actor {\n  constructor(palette) {\n    super({\n      collisionGeometry: (\n        (new CylinderBufferGeometry(0.25, 0.25, 1.4))\n          .translate(0, 0.7, 0)\n      ),\n      geometry: Dude.geometry(palette),\n      material: Dude.material,\n    });\n    const { skeleton: { bones } } = this;\n    Object.keys(Dude.bones).forEach((bone) => {\n      bones[Actor.Bones[bone]].position.copy(Dude.bones[bone]);\n    });\n  }\n}\n\nDude.bones = {\n  hip: new Vector3(0, 0.5, 0),\n  torso: new Vector3(0, 0, 0),\n  head: new Vector3(0, 0.49, 0),\n  leftArm: new Vector3(-0.15, 0.475, 0),\n  rightArm: new Vector3(0.15, 0.475, 0),\n  leftLeg: new Vector3(-0.075, 0, 0),\n  rightLeg: new Vector3(0.075, 0, 0),\n};\n\nDude.geometry = (palette) => {\n  const torso = new CylinderGeometry(0.175, 0.15, 0.5, 6);\n  torso.translate(0, 0.25, 0);\n  torso.faces.forEach((face) => {\n    face.color.set(palette.torso || 0x990000);\n  });\n  const head = new SphereGeometry(0.2, 8, 4);\n  head.translate(0, 0.2, 0);\n  head.faces.forEach((face) => {\n    face.color.set(palette.head);\n  });\n  if (palette.hat) {\n    const hat = new CylinderGeometry(0.3, 0.3, 0.05);\n    const top = new CylinderGeometry(0.2, 0.2, 0.3);\n    top.translate(0, 0.15, 0);\n    hat.merge(top);\n    hat.translate(0, 0.3, 0);\n    hat.faces.forEach((face) => {\n      face.color.set(palette.hat);\n    });\n    head.merge(hat);\n  }\n  const leftEye = new SphereGeometry(0.05);\n  leftEye.faces.forEach((face) => {\n    face.color.set(palette.eyes);\n  });\n  const rightEye = leftEye.clone();\n  leftEye.translate(-0.1, 0.2, 0.15);\n  rightEye.translate(0.1, 0.2, 0.15);\n  head.merge(leftEye);\n  head.merge(rightEye);\n  const leftArm = new CylinderGeometry(0.05, 0.03, 0.4, 6);\n  leftArm.faces.forEach((face) => {\n    face.color.set(palette.arms);\n  });\n  const rightArm = leftArm.clone();\n  leftArm.translate(0, -0.2, 0);\n  rightArm.translate(0, -0.2, 0);\n  const leftLeg = new CylinderGeometry(0.05, 0.05, 0.5, 4);\n  leftLeg.faces.forEach((face) => {\n    face.color.set(palette.legs);\n  });\n  const rightLeg = leftLeg.clone();\n  leftLeg.translate(0, -0.25, 0);\n  rightLeg.translate(0, -0.25, 0);\n  const geometry = Actor.geometryFromLimbs({\n    torso,\n    head,\n    leftArm,\n    rightArm,\n    leftLeg,\n    rightLeg,\n  });\n  geometry.boundingSphere.center.set(0, 0.7, 0);\n  geometry.boundingSphere.radius = 0.7;\n  return geometry;\n};\n\nDude.material = new MeshPhongMaterial({\n  skinning: true,\n  vertexColors: VertexColors,\n});\n\nexport default Dude;\n","import {\n  CircleBufferGeometry,\n  Mesh,\n  MeshPhongMaterial,\n} from 'three';\n\nclass Marker extends Mesh {\n  constructor() {\n    const geometry = new CircleBufferGeometry(0.25, 16);\n    geometry.rotateX(Math.PI * -0.5);\n    geometry.translate(0, 0.001, 0);\n    super(\n      geometry,\n      new MeshPhongMaterial({\n        color: 0x222222,\n        transparent: true,\n      })\n    );\n    this.visible = false;\n  }\n\n  onAnimationTick({ time }) {\n    const { material, scale, visible } = this;\n    if (!visible) return;\n    const inc = ((1 + Math.sin(time * 4)) * 0.125);\n    const s = 0.75 + inc;\n    scale.set(s, 1, s);\n    material.opacity = 0.25 + inc;\n  }\n}\n\nexport default Marker;\n","import Dude from '@/actors/dude';\nimport Marker from '@/items/marker';\n\nexport default ({ input, scene }) => {\n  const pack = {\n    dudes: [...Array(13)].map((v, i) => {\n      const dude = new Dude({\n        arms: 0x222222,\n        eyes: i === 0 ? 0x990000 : (0x999999 * Math.random()),\n        head: i === 0 ? 0x333333 : (0x999999 * Math.random()),\n        hat: Math.random() > 0.5 ? (0x999999 * Math.random()) : false,\n        legs: 0x222222,\n        torso: i === 0 ? 0x990000 : (0x999999 * Math.random()),\n      });\n      dude.position.set(Math.floor((i + 1) / 2) * ((i + 1) % 2 === 0 ? 1 : -1), 0, 0);\n      scene.root.add(dude);\n      return dude;\n    }),\n    onAnimationTick() {\n      const { camera, grid } = scene;\n      const pointer = input.getPointerFrame();\n      camera.processInput(pointer);\n      if (pointer.primaryUp) {\n        const { raycaster } = pointer;\n        raycaster.setFromCamera(pointer.normalized, camera);\n        const hit = raycaster.intersectObject(grid)[0];\n        if (!hit) return;\n        pack.walkTo(hit.point);\n      }\n    },\n    walkTo(point) {\n      const { x: mainDudeX, z: mainDudeZ } = point;\n      this.dudes.forEach((dude, i) => {\n        point.x = mainDudeX + Math.floor((i + 1) / 2) * ((i + 1) % 2 === 0 ? 1 : -1);\n        point.z = mainDudeZ + Math.floor((i + 1) / 2) * -1;\n        if (i > 0) {\n          point.x += (Math.random() * 2) - 1;\n          point.z += (Math.random() * 2) - 1;\n          dude.actions.walk.timeScale = 0.8 + Math.random() * 0.4;\n        }\n        dude.walk([point.clone()]);\n      });\n    },\n  };\n\n  const [mainDude] = pack.dudes;\n  mainDude.destinationMarker = new Marker();\n  scene.root.add(mainDude.destinationMarker);\n  scene.camera.target = mainDude.position;\n\n  scene.camera.distance = 6;\n  scene.camera.pitch = Math.PI * 0.125;\n  scene.camera.updateOrbit();\n\n  scene.onAnimationTick = pack.onAnimationTick.bind(pack);\n};\n","import {\n  BoxGeometry,\n  BufferGeometry,\n  Color,\n  DoubleSide,\n  Mesh,\n  MeshPhongMaterial,\n  VertexColors,\n} from 'three';\n\nclass Cabin extends Mesh {\n  constructor({\n    color,\n    scale,\n  }) {\n    const geometry = new BoxGeometry(\n      0.998, 0.999, 0.998,\n      scale.x, scale.y, scale.z\n    );\n    const aux = new Color();\n    geometry.faces.forEach((face, i) => {\n      if (i % 2 === 0) {\n        aux.setHSL(Math.random(), 0.05, 0.25 + (Math.random() * 0.125));\n      }\n      face.color.copy(aux);\n    });\n    geometry.translate(0, 0.5, 0);\n    for (let i = 0; i < 12; i += 1) {\n      geometry.faces.splice(40, 1);\n    }\n    geometry.scale(scale.x, scale.y, scale.z);\n    super(\n      (new BufferGeometry()).fromGeometry(geometry),\n      new MeshPhongMaterial({\n        color,\n        side: DoubleSide,\n        vertexColors: VertexColors,\n      })\n    );\n  }\n}\n\nexport default Cabin;\n","import {\n  BoxBufferGeometry,\n  Math as ThreeMath,\n  Mesh,\n  MeshPhongMaterial,\n  Vector3,\n} from 'three';\n\nclass Button extends Mesh {\n  constructor({ onTap, position }) {\n    const geometry = new BoxBufferGeometry(0.2, 0.1, 0.1);\n    geometry.translate(0, 0, 0.049);\n    super(\n      geometry,\n      new MeshPhongMaterial({\n        color: 0x440000,\n      })\n    );\n    this.animation = 0;\n    this.animationVector = new Vector3(0, 0, -0.05);\n    this.onTap = onTap;\n    this.position.copy(position);\n    this.origin = position.clone();\n  }\n\n  tap() {\n    const { onTap, tapping } = this;\n    if (tapping) return false;\n    let ret;\n    if (onTap) {\n      ret = onTap();\n    }\n    this.animation = 0;\n    this.tapping = true;\n    return ret;\n  }\n\n  onAnimationTick({ delta }) {\n    const { animationVector, origin, tapping } = this;\n    if (!tapping) return;\n    this.animation = Math.min(this.animation + (delta * 0.75), 1);\n    if (this.animation === 1) {\n      delete this.tapping;\n    }\n    const step = ThreeMath.smoothstep(\n      (this.animation > 0.5 ? 1 - this.animation : this.animation) * 2,\n      0,\n      1\n    );\n    this.position\n      .copy(origin)\n      .addScaledVector(animationVector, step);\n  }\n}\n\nexport default Button;\n","import {\n  BufferGeometry,\n  Color,\n  DoubleSide,\n  Math as ThreeMath,\n  Mesh,\n  MeshPhongMaterial,\n  Object3D,\n  PlaneGeometry,\n  VertexColors,\n  Vector3,\n} from 'three';\nimport Button from '@/items/button';\n\nclass Doors extends Object3D {\n  constructor({\n    color,\n    onCall,\n    scale,\n  }) {\n    super();\n    const plane = new PlaneGeometry(0.5, 1, scale.x * 0.5, scale.y);\n    const aux = new Color();\n    plane.faces.forEach((face, i) => {\n      if (i % 2 === 0) {\n        aux.setHSL(Math.random(), 0.05, 0.25 + (Math.random() * 0.125));\n      }\n      face.color.copy(aux);\n    });\n    plane.scale(scale.x, scale.y, scale.z);\n    const geometry = (new BufferGeometry()).fromGeometry(plane);\n    for (let i = 0; i < 2; i += 1) {\n      const door = new Mesh(\n        geometry,\n        new MeshPhongMaterial({\n          color,\n          side: DoubleSide,\n          vertexColors: VertexColors,\n        })\n      );\n      door.position.set(\n        (-0.26 + (i * 0.52)) * scale.x,\n        0.5 * scale.y,\n        0.499 * scale.z\n      );\n      this.add(door);\n    }\n    this.animation = 0;\n    this.animationScale = scale.x;\n    this.state = Doors.states.CLOSED;\n    this.targetState = this.state;\n    this.callButton = new Button({\n      onTap: onCall,\n      position: new Vector3(0.6 * scale.x, (1 / 3) * scale.y, 0.5 * scale.z),\n    });\n    this.add(this.callButton);\n  }\n\n  open() {\n    this.state = Doors.states.MOVING;\n    this.targetState = Doors.states.OPEN;\n  }\n\n  close() {\n    this.state = Doors.states.MOVING;\n    this.targetState = Doors.states.CLOSED;\n  }\n\n  toggle() {\n    const { state } = this;\n    switch (state) {\n      case Doors.states.OPEN:\n        this.close();\n        break;\n      case Doors.states.CLOSED:\n        this.open();\n        break;\n      default:\n        break;\n    }\n  }\n\n  onAnimationTick(animation) {\n    const {\n      animationScale,\n      children,\n      state,\n      targetState,\n    } = this;\n    this.callButton.onAnimationTick(animation);\n    if (state !== Doors.states.MOVING) return;\n    const { delta } = animation;\n    const animationStep = delta * 0.75;\n    switch (targetState) {\n      case Doors.states.OPEN:\n        this.animation = Math.min(this.animation + animationStep, 1);\n        if (this.animation === 1) {\n          this.state = Doors.states.OPEN;\n        }\n        break;\n      case Doors.states.CLOSED:\n        this.animation = Math.max(this.animation - animationStep, 0);\n        if (this.animation === 0) {\n          this.state = Doors.states.CLOSED;\n        }\n        break;\n      default:\n        break;\n    }\n    const step = ThreeMath.smoothstep(this.animation, 0, 1) * 0.4;\n    for (let i = 0; i < 2; i += 1) {\n      children[i].position.x = (-0.26 + (i * 0.52) + (step * (i === 0 ? -1 : 1))) * animationScale;\n    }\n  }\n}\n\nDoors.states = {\n  OPEN: 0,\n  CLOSED: 1,\n  MOVING: 2,\n};\n\nexport default Doors;\n","import {\n  BufferGeometry,\n  DoubleSide,\n  Geometry,\n  Mesh,\n  MeshPhongMaterial,\n  PlaneGeometry,\n} from 'three';\n\nclass Shaft extends Mesh {\n  constructor({\n    color,\n    floors,\n    scale,\n  }) {\n    const merged = new Geometry();\n    for (let i = 0; i <= floors; i += 1) {\n      if (i === 0 || i === floors) {\n        const floor = new PlaneGeometry(1, 1);\n        floor.rotateX(Math.PI * -0.5);\n        floor.translate(0, i, 0);\n        merged.merge(floor);\n        if (i === floors) break;\n      }\n      const back = new PlaneGeometry(1, 1);\n      back.translate(0, i + 0.5, -0.5);\n      merged.merge(back);\n      const side = new PlaneGeometry(1, 1);\n      side.rotateY(Math.PI * -0.5);\n      side.translate(-0.5, i + 0.5, 0);\n      merged.merge(side);\n      side.translate(1, 0, 0);\n      merged.merge(side);\n    }\n    merged.scale(scale.x, scale.y, scale.z);\n    super(\n      (new BufferGeometry()).fromGeometry(merged),\n      new MeshPhongMaterial({\n        color,\n        side: DoubleSide,\n      })\n    );\n  }\n}\n\nexport default Shaft;\n","import {\n  Math as ThreeMath,\n  Object3D,\n  Vector3,\n} from 'three';\nimport Cabin from './cabin';\nimport Doors from './doors';\nimport Shaft from './shaft';\n\nclass Elevator extends Object3D {\n  constructor({\n    floors,\n    origin,\n  }) {\n    super();\n    this.floors = floors;\n    this.origin = origin;\n    this.animationStart = Math.random() * 512;\n\n    this.shaft = new Shaft({\n      color: Elevator.shaft,\n      floors,\n      scale: Elevator.scale,\n    });\n    this.add(this.shaft);\n\n    this.doors = [...Array(floors)].map((v, floor) => {\n      const doors = new Doors({\n        color: Elevator.doors,\n        onCall: () => this.onCall(floor),\n        scale: Elevator.scale,\n      });\n      doors.position.y = floor * Elevator.scale.y;\n      this.add(doors);\n      return doors;\n    });\n\n    this.cabin = new Cabin({\n      color: Elevator.cabin,\n      scale: Elevator.scale,\n    });\n    this.add(this.cabin);\n    this.position.z = -1.5 * Elevator.scale.z;\n    this.floor = 0;\n  }\n\n  onAnimationTick(animation) {\n    const { cabin, doors, route } = this;\n    if (route) {\n      route.step += animation.delta * 0.75;\n      if (route.step >= 1) {\n        route.step = 1;\n        doors[route.to].open();\n        this.floor = route.to;\n        delete this.route;\n      }\n      const step = ThreeMath.smoothstep(route.step, 0, 1) * route.travel;\n      cabin.position.y = (route.from + step) * Elevator.scale.y;\n    }\n    doors.forEach(door => door.onAnimationTick(animation));\n  }\n\n  onCall(floor) {\n    const { route, doors } = this;\n    if (route) return;\n    if (floor === this.floor) {\n      doors[floor].toggle();\n      return;\n    }\n    doors[this.floor].close();\n    this.route = {\n      from: this.floor,\n      to: floor,\n      travel: floor - this.floor,\n      step: 0,\n    };\n  }\n}\n\nElevator.scale = new Vector3(2, 3, 2);\nElevator.cabin = 0x440000;\nElevator.doors = 0x333333;\nElevator.shaft = 0x333333;\n\nexport default Elevator;\n","import {\n  BufferGeometry,\n  Color,\n  DoubleSide,\n  Mesh,\n  MeshPhongMaterial,\n  PlaneGeometry,\n  Vector3,\n  VertexColors,\n} from 'three';\n\nclass Wall extends Mesh {\n  static getGeometry({\n    aoTop = true,\n    aoBottom = true,\n    width = 1,\n    height = 1,\n    material,\n    orientation,\n  }) {\n    const wall = new PlaneGeometry(\n      width,\n      height,\n      Math.ceil(width * Wall.scale.x),\n      Math.ceil(height * (orientation === 'horizontal' ? Wall.scale.x : Wall.scale.y))\n    );\n    const color = new Color();\n    wall.faces.forEach((face, i) => {\n      if (i % 2 === 0) {\n        color.setHSL(Math.random(), 0.05, 0.25 + (Math.random() * 0.125));\n      }\n      face.materialIndex = material;\n      const vertices = [\n        wall.vertices[face.a],\n        wall.vertices[face.b],\n        wall.vertices[face.c],\n      ];\n      face.vertexColors = [...Array(3)].map((v, j) => {\n        const c = color.clone();\n        if (\n          (aoTop && Math.abs(vertices[j].y - height * 0.5) < 0.0001)\n          || (aoBottom && Math.abs(vertices[j].y - height * -0.5) < 0.0001)\n        ) {\n          c.offsetHSL(0, 0, -0.1);\n        }\n        return c;\n      });\n    });\n    if (orientation === 'horizontal') {\n      wall.rotateX(Math.PI * -0.5);\n    }\n    return wall;\n  }\n\n  constructor({\n    aoTop = false,\n    aoBottom = false,\n  } = {}) {\n    const geometry = Wall.getGeometry({\n      aoTop,\n      aoBottom,\n      orientation: 'vertical',\n      material: 0,\n    });\n    geometry.translate(0, 0.5, -0.5);\n    geometry.scale(Wall.scale.x, Wall.scale.y, Wall.scale.z);\n    super(\n      (new BufferGeometry()).fromGeometry(geometry),\n      new MeshPhongMaterial({\n        side: DoubleSide,\n        vertexColors: VertexColors,\n      })\n    );\n  }\n}\n\nWall.scale = new Vector3(4, 3, 4);\n\nexport default Wall;\n","import {\n  BufferGeometry,\n  DoubleSide,\n  Geometry,\n  Mesh,\n  MeshPhongMaterial,\n  VertexColors,\n} from 'three';\nimport GridMaterial from '@/materials/grid';\nimport Wall from './wall';\n\nclass Hallway extends Mesh {\n  constructor({\n    hasCeiling,\n    hasElevator,\n    isEdge,\n    isLobby,\n  }) {\n    const merged = new Geometry();\n    const floor = Wall.getGeometry({\n      aoBottom: !isLobby,\n      material: 0,\n      orientation: 'horizontal',\n    });\n    merged.merge(floor);\n    if (hasElevator) {\n      const wall = Wall.getGeometry({\n        aoTop: hasCeiling,\n        width: 0.25,\n        material: 1,\n      });\n      wall.translate(-0.375, 0.5, -0.5);\n      merged.merge(wall);\n      wall.translate(0.75, 0, 0);\n      merged.merge(wall);\n    } else {\n      const wall = Wall.getGeometry({\n        aoTop: hasCeiling,\n        material: 1,\n      });\n      wall.translate(0, 0.5, -0.5);\n      merged.merge(wall);\n    }\n    if (!isLobby) {\n      const wall = Wall.getGeometry({\n        aoTop: false,\n        height: 1 / 3,\n        material: 1,\n      });\n      wall.rotateY(Math.PI);\n      wall.translate(0, 1 / 3 / 2, 0.5);\n      merged.merge(wall);\n      if (isEdge) {\n        const wall = Wall.getGeometry({\n          aoTop: false,\n          height: 1 / 3,\n          material: 1,\n        });\n        wall.rotateY(Math.PI * 0.5 * (isEdge === 'left' ? 1 : -1));\n        wall.translate(isEdge === 'left' ? -0.5 : 0.5, 1 / 3 / 2, 0);\n        merged.merge(wall);\n      }\n    }\n    merged.scale(Wall.scale.x, Wall.scale.y, Wall.scale.z);\n    super(\n      (new BufferGeometry()).fromGeometry(merged),\n      [\n        new GridMaterial({\n          side: DoubleSide,\n          vertexColors: VertexColors,\n        }),\n        new MeshPhongMaterial({\n          side: DoubleSide,\n          vertexColors: VertexColors,\n        }),\n      ]\n    );\n  }\n}\n\nexport default Hallway;\n","import {\n  BufferGeometry,\n  Geometry,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneGeometry,\n  Vector3,\n} from 'three';\n\nimport { AStarFinder, Grid } from 'pathfinding';\n\nclass Walkable extends Mesh {\n  constructor(grid) {\n    const geometry = new Geometry();\n    const floor = new PlaneGeometry(1024, 1024, 2, 2);\n    floor.rotateX(Math.PI * -0.5);\n    floor.translate(0, 0, 512);\n    const intersect = new PlaneGeometry(1024, 1024, 2, 2);\n    intersect.translate(0, 512, 0);\n    geometry.merge(floor);\n    geometry.merge(intersect);\n    super(\n      (new BufferGeometry()).fromGeometry(geometry),\n      new MeshBasicMaterial({\n        transparent: true,\n        visible: false,\n      })\n    );\n    this.finder = new AStarFinder({\n      allowDiagonal: true,\n      dontCrossCorners: true,\n    });\n    this.grid = new Grid(grid);\n    this.grid.setWalkableAt(0, 1, true);\n  }\n\n  getPath(from, to) {\n    const { grid, finder } = this;\n    from = this.worldToGrid(from);\n    to = this.worldToGrid(to);\n    return finder.findPath(from.x, from.z, to.x, to.z, grid.clone()).map(([x, z]) => (\n      this.localToWorld(new Vector3(x + 0.5, 0, z + 0.5))\n    ));\n  }\n\n  worldToGrid(point) {\n    const { grid, position } = this;\n    point.y = position.y;\n    this.worldToLocal(point);\n    point.x = Math.min(Math.max(point.x, 0), grid.width - 1);\n    point.z = Math.min(Math.max(point.z, 0), grid.height - 1);\n    point = {\n      x: Math.floor(point.x),\n      z: Math.floor(point.z),\n    };\n    while (!grid.isWalkableAt(point.x, point.z) && point.z < grid.height - 1) {\n      point.z += 1;\n    }\n    return point;\n  }\n}\n\nexport default Walkable;\n","import { Object3D } from 'three';\nimport Elevator from './elevator';\nimport Hallway from './hallway';\nimport Wall from './wall';\nimport Walkable from '@/engine/walkable';\n\nclass Building extends Object3D {\n  constructor({\n    elevators,\n    floors,\n  }) {\n    super();\n    this.elevators = elevators.map(({\n      floors,\n      origin,\n    }) => {\n      const elevator = new Elevator({ floors, origin });\n      elevator.position.x = origin.x * 4;\n      elevator.position.y = origin.y * 3;\n      this.add(elevator);\n      return elevator;\n    });\n    const width = floors.reduce((width, layout) => Math.max(width, layout.split('').length * 4), 0);\n    this.heightmap = [...Array(6)].map(() => [...Array(width)].map(() => (0)));\n    this.floors = floors.map((layout, floor) => {\n      const buttons = [];\n      const rooms = layout.split('');\n      const grid = [...Array(4)].map(() => [...Array(rooms.length * 4)].map(() => (1)));\n      rooms.forEach((type, room) => {\n        let mesh;\n        switch (type) {\n          case ' ':\n            return;\n          case '_':\n            mesh = new Wall();\n            break;\n          case '.':\n          default: {\n            let isEdge = false;\n            if (room === 0 || ~[' ', '_'].indexOf(rooms[room - 1])) isEdge = 'left';\n            else if (room === rooms.length - 1 || ~[' ', '_'].indexOf(rooms[room + 1])) isEdge = 'right';\n            const hasCeiling = floor < floors.length - 1 && [' ', '_'].indexOf(floors[floor + 1].split('')[room]) === -1;\n            const elevatorIndex = (\n              this.elevators.findIndex(({\n                floors,\n                origin,\n              }) => (\n                origin.x === room\n                && origin.y <= floor\n                && origin.y + floors > floor\n              ))\n            );\n            const hasElevator = ~elevatorIndex;\n            if (hasElevator) {\n              const elevator = this.elevators[elevatorIndex];\n              buttons.push(elevator.doors[floor - elevator.origin.y].callButton);\n            }\n            mesh = new Hallway({\n              hasCeiling,\n              hasElevator,\n              isEdge,\n              isLobby: floor === 0,\n            });\n            for (let x = 0; x < 4; x += 1) {\n              for (let z = 0; z < 6; z += 1) {\n                if (z > 1) {\n                  this.heightmap[z][(room * 4) + x] = floor * 3;\n                } else if (hasElevator && x > 0 && x < 3) {\n                  this.heightmap[z][(room * 4) + x] = (floor + 1) * 3;\n                }\n              }\n              for (let y = 0; y < 4; y += 1) {\n                grid[y][(room * 4) + x] = 0;\n              }\n            }\n            break;\n          }\n        }\n        mesh.position.set(room * 4, floor * 3, 0);\n        this.add(mesh);\n      });\n      const walkable = new Walkable(grid);\n      walkable.buttons = buttons;\n      walkable.position.set(-2, floor * 3, -2);\n      this.add(walkable);\n      return walkable;\n    });\n  }\n\n  addToFloorGrid({\n    floor,\n    mesh,\n    x,\n    z,\n  }) {\n    const { floors: { [floor]: walkable } } = this;\n    walkable.grid.setWalkableAt(x, z, false);\n    mesh.position.set(x + 0.5, 0, z + 0.5).add(walkable.position);\n    this.add(mesh);\n  }\n\n  getHeight(x, z) {\n    const { heightmap } = this;\n    x = Math.floor(x + 2);\n    z = Math.floor(z + 4);\n    if (\n      x < 0\n      || x > heightmap[0].length - 1\n      || z < 0\n      || z > heightmap.length - 1\n    ) {\n      return 0;\n    }\n    return heightmap[z][x];\n  }\n\n  onAnimationTick(animation) {\n    const { children } = this;\n    children.forEach((child) => {\n      if (child.onAnimationTick) {\n        child.onAnimationTick(animation);\n      }\n    });\n  }\n}\n\nexport default Building;\n","import Dude from '@/actors/dude';\nimport Building from '@/building';\nimport Marker from '@/items/marker';\n\nexport default ({ input, scene }) => {\n  /* Spawn player */\n  const player = new Dude({\n    arms: 0x222222,\n    eyes: 0x990000,\n    head: 0x333333,\n    legs: 0x222222,\n    torso: 0x990000,\n  });\n  player.position.set(6, 3, 0);\n  player.destinationMarker = new Marker();\n  scene.root.add(player);\n  scene.root.add(player.destinationMarker);\n  scene.camera.maxHeight = 2.9;\n  scene.camera.target = player.position;\n\n  /* Spawn test building */\n  const building = new Building({\n    elevators: [\n      {\n        floors: 2,\n        origin: { x: 1, y: 0 },\n      },\n      {\n        floors: 3,\n        origin: { x: 4, y: 1 },\n      },\n    ],\n    floors: [\n      '  ...',\n      ' .._..',\n      ' .._..',\n      '......',\n      '......',\n    ].reverse(),\n  });\n  scene.root.add(building);\n  scene.rain.position.x = building.heightmap[0].length * 0.5;\n  scene.rain.setHeightTest(building.getHeight.bind(building));\n\n  /* Spawn some dudes */\n  const dudes = [...Array(4)].map(() => {\n    const dude = new Dude({\n      arms: 0x222222,\n      eyes: 0x999999 * Math.random(),\n      hat: Math.random() > 0.5 ? (0x999999 * Math.random()) : false,\n      head: 0x999999 * Math.random(),\n      legs: 0x222222,\n      torso: 0x999999 * Math.random(),\n    });\n    const floor = Math.floor(Math.random() * 2);\n    const { grid } = building.floors[floor];\n    let spawn;\n    do {\n      spawn = {\n        x: Math.floor(Math.random() * grid.width),\n        z: Math.floor(Math.random() * grid.height - 1),\n      };\n    } while (!grid.isWalkableAt(spawn.x, spawn.z));\n    building.addToFloorGrid({\n      floor,\n      mesh: dude,\n      ...spawn,\n    });\n    return dude.collisionMesh;\n  });\n\n  /* Animation loop */\n  const floor = 1;\n  scene.onAnimationTick = () => {\n    const { camera } = scene;\n    const pointer = input.getPointerFrame();\n    camera.processInput(pointer);\n    if (pointer.primaryUp) {\n      const { raycaster } = pointer;\n      raycaster.setFromCamera(pointer.normalized, camera);\n      const walkable = building.floors[floor];\n      {\n        const hit = raycaster.intersectObjects(dudes)[0];\n        if (hit) {\n          const { object: { parent: dude } } = hit;\n          const lines = [\n            'Fuck You',\n            'Go away',\n            'Leave me alone',\n          ];\n          const onDestination = () => {\n            player.faceTo(dude.position);\n            setTimeout(() => (\n              dude.say([lines[Math.floor(Math.random() * lines.length)]])\n            ), 500);\n          };\n          const path = walkable.getPath(player.position.clone(), dude.position.clone());\n          if (path.length > 1) {\n            player.walk(path.slice(1), onDestination);\n          } else if (path.length) {\n            onDestination();\n          }\n          return;\n        }\n      }\n      {\n        const hit = raycaster.intersectObjects(walkable.buttons)[0];\n        if (hit) {\n          const { point, object: button } = hit;\n          const onDestination = () => {\n            player.faceTo(point);\n            button.tap();\n          };\n          const path = walkable.getPath(player.position.clone(), point.clone());\n          if (path.length > 1) {\n            player.walk(path.slice(1), onDestination);\n          } else if (path.length) {\n            onDestination();\n          }\n          return;\n        }\n      }\n      {\n        const hit = raycaster.intersectObject(walkable)[0];\n        if (hit) {\n          const path = walkable.getPath(player.position.clone(), hit.point);\n          if (path.length > 1) {\n            player.walk(path.slice(1));\n          }\n        }\n      }\n    }\n  };\n};\n","export { default as debug } from './debug';\nexport { default as game } from './game';\n","import {\n  ShaderLib,\n  ShaderMaterial,\n  UniformsUtils,\n} from 'three';\n\nclass GridMaterial extends ShaderMaterial {\n  constructor({\n    color = 0xFFFFFF,\n    size = 1,\n    subdivisions = 10,\n    ...rest\n  } = {}) {\n    const vertexShader = ShaderLib.phong.vertexShader.replace(\n      '#include <clipping_planes_pars_vertex>',\n      [\n        '#include <clipping_planes_pars_vertex>',\n        'varying vec3 vPosition;',\n      ].join('\\n')\n    ).replace(\n      '#include <fog_vertex>',\n      [\n        '#include <fog_vertex>',\n        'vPosition = (modelMatrix * vec4( transformed, 1.0 )).xyz;',\n      ].join('\\n')\n    );\n    const primaryGrid = 1 / size;\n    const secondaryGrid = primaryGrid * subdivisions;\n    const fragmentShader = ShaderLib.phong.fragmentShader.replace(\n      '#include <clipping_planes_pars_fragment>',\n      [\n        '#include <clipping_planes_pars_fragment>',\n        'varying vec3 vPosition;',\n        'float getGrid(float scale) {',\n        ' vec2 coord = vPosition.xz * scale;',\n        ' vec2 grid = abs(fract(coord - 0.5) - 0.5) / fwidth(coord);',\n        ' return 1.0 - min(min(grid.x, grid.y), 1.0);',\n        '}',\n      ].join('\\n')\n    ).replace(\n      'vec4 diffuseColor = vec4( diffuse, opacity );',\n      [\n        `float primaryGrid = getGrid(${primaryGrid}${primaryGrid % 1 === 0 ? '.0' : ''});`,\n        `float secondaryGrid = getGrid(${secondaryGrid}${secondaryGrid % 1 === 0 ? '.0' : ''});`,\n        'vec3 grid = mix(mix(diffuse, diffuse * 0.95, secondaryGrid), diffuse * 1.15, primaryGrid);',\n        'vec4 diffuseColor = vec4(grid, opacity);',\n      ].join('\\n')\n    );\n    super({\n      name: `grid-material-${size}-${subdivisions}`,\n      uniforms: UniformsUtils.clone(ShaderLib.phong.uniforms),\n      fragmentShader,\n      vertexShader,\n      extensions: { derivatives: true },\n      fog: true,\n      lights: true,\n      ...rest,\n    });\n    this.color = this.uniforms.diffuse.value;\n    this.color.set(color);\n  }\n}\n\nexport default GridMaterial;\n","import Input from '@/engine/input';\nimport Music from '@/engine/music';\nimport Scene from '@/engine/scene';\nimport * as Scenes from '@/scenes';\n\nconst mount = document.getElementById('mount');\nconst input = new Input({ mount });\nconst music = new Music({ toggle: document.getElementById('sound') });\nconst scene = new Scene({ mount });\n\nlet route = window.location.hash.split('/').slice(1)[0];\nif (!Scenes[route]) {\n  window.location.hash = '/game';\n  route = 'game';\n}\nsetImmediate(() => window.addEventListener('hashchange', () => window.location.reload(), false));\n\nfunction onLoad() {\n  document.body.className = 'loaded';\n  Scenes[route]({ input, scene });\n  input.touches.once('end', () => {\n    document.getElementById('splash').style.display = 'none';\n    input.isEnabled = true;\n    music.play();\n  });\n}\n\nfunction waitForFonts(fonts) {\n  let loaded = 0;\n  fonts.forEach(({ font, test }) => {\n    const fontTester = document.createElement('div');\n    fontTester.innerText = test;\n    fontTester.style.position = 'absolute';\n    fontTester.style.fontFamily = 'sans-serif';\n    fontTester.style.top = '-999999px';\n    document.body.appendChild(fontTester);\n    const { width: initialWidth } = fontTester.getBoundingClientRect();\n    fontTester.style.fontFamily = font;\n    const check = () => {\n      const { width } = fontTester.getBoundingClientRect();\n      if (width > initialWidth) {\n        document.body.removeChild(fontTester);\n        loaded += 1;\n        if (loaded === fonts.length) {\n          onLoad();\n        }\n      } else {\n        setTimeout(check, 10);\n      }\n    };\n    check();\n  });\n}\n\nwaitForFonts([\n  { font: \"'Print Char 21'\", test: 'QW@HhsXJ' },\n]);\n","import {\n  CanvasTexture,\n  SpriteMaterial as ThreeSprite,\n} from 'three';\n\nclass SpriteMaterial extends ThreeSprite {\n  constructor({ width, height, ...rest }) {\n    const renderer = document.createElement('canvas');\n    renderer.width = width;\n    renderer.height = height;\n    const texture = new CanvasTexture(renderer);\n    super({\n      map: texture,\n      ...rest,\n    });\n    this.renderer = renderer;\n    this.ctx = renderer.getContext('2d');\n  }\n}\n\nexport default SpriteMaterial;\n"],"sourceRoot":""}