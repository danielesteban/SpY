(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{0:function(t,e,n){n("FlHw"),t.exports=n("tjUo")},FlHw:function(t,e,n){},Qw7Z:function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}var r=function(){function r(t){var e=this,n=t.toggle;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var o=document.createElement("script");o.async=!0,o.defer=!0,o.src="https://connect.soundcloud.com/sdk/sdk-3.3.1.js",document.body.appendChild(o),function t(){window.SC?(e.api=window.SC,e.api.initialize({client_id:"eb5fcff9e107aab508431b4c3c416415"}),e.tracks=r.shuffle([14281750,14449372,201545618,130450594,43516158,20969172,6582510,89379153,96594845,199889475,137188503,74658085,90256034,183847047,3916883]),e.track=0,n.addEventListener("click",function(){return e.toggle(n)},!1),e.wantsToPlay&&(delete e.wantsToPlay,e.play())):setTimeout(t,10)}()}return i(r,null,[{key:"shuffle",value:function(t){for(var e=t.length-1;0<=e;e-=1){var n=Math.floor(Math.random()*t.length),o=t[e];t[e]=t[n],t[n]=o}return t}}]),i(r,[{key:"next",value:function(){this.track=(this.track+1)%this.tracks.length,this.play()}},{key:"play",value:function(){var e=this,t=this.api,n=this.player,o=this.track,r=this.tracks;if(t){n&&(n.kill(),delete this.player);var i=r[o];0,t.stream("/tracks/".concat(i)).then(function(t){(e.player=t).on("audio_error",function(){return e.next()}),t.on("finish",function(){return e.next()}),t.setVolume(.8),t.play()}).catch(function(){e.next()})}else this.wantsToPlay=!0}},{key:"toggle",value:function(t){var e=this.player;e&&(e.isPlaying()?(e.pause(),t.className="muted"):(t.className="",e.play()))}}]),r}();e.a=r},"T5+8":function(t,e,n){"use strict";var r=n("Womt"),o=n("1339"),i=n.n(o),a=n("fWck");function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var s=function(){function o(t){var e=t.mount,n=void 0===e?document.body:e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.mount=n,this.keyboard={backwards:!1,forwards:!1,leftwards:!1,rightwards:!1},this.pointer={current:new r.Z(0,0),movement:{x:0,y:0},normalized:new r.Z(0,0),last:new r.Z(0,0),wheel:0},this.touches=i()(window,{preventSimulated:!1,target:n}).on("start",this.onPointerDown.bind(this)).on("move",this.onPointerMove.bind(this)).on("end",this.onPointerUp.bind(this)),Object(a.addWheelListener)(window,this.onPointerWheel.bind(this)),window.addEventListener("blur",this.onBlur.bind(this),!1),window.addEventListener("contextmenu",function(t){return t.preventDefault()},!1),window.addEventListener("keydown",this.onKeydown.bind(this),!1),window.addEventListener("keyup",this.onKeyup.bind(this),!1),window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize()}var t,e,n;return t=o,(e=[{key:"getPointerFrame",value:function(){var t=this.pointer,e=function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},e=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.forEach(function(t){var e,n,o;e=r,o=i[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return r}({},t);return t.primaryDown=!1,t.primaryUp=!1,t.secondaryDown=!1,t.secondaryUp=!1,t.movement={x:0,y:0},t.wheel=0,e}},{key:"onBlur",value:function(){var t=this.keyboard;t.forwards=!1,t.backwards=!1,t.leftwards=!1,t.rightwards=!1}},{key:"onKeydown",value:function(t){var e=t.keyCode,n=t.repeat,o=t.target,r=this.keyboard;if(!n&&!~["INPUT","TEXTAREA"].indexOf(o.tagName))switch(e){case 87:r.forwards=!0;break;case 83:r.backwards=!0;break;case 65:r.leftwards=!0;break;case 68:r.rightwards=!0}}},{key:"onKeyup",value:function(t){var e=t.keyCode,n=t.repeat,o=this.keyboard;if(!n)switch(e){case 87:o.forwards=!1;break;case 83:o.backwards=!1;break;case 65:o.leftwards=!1;break;case 68:o.rightwards=!1}}},{key:"onPointerDown",value:function(t){var e=this.isEnabled,n=this.pointer;if(e&&"CANVAS"===t.target.tagName){var o=t.button,r=t.touches;if(r)return 1<r.length&&t.preventDefault(),void(n.secondary||(1===r.length?(n.primary=!0,n.primaryDown=!0):(n.secondary=!0,n.secondaryDown=!0,n.primary=!1)));switch(o){case 0:n.primary=!0,n.primaryDown=!0;break;case 2:n.secondary=!0,n.secondaryDown=!0}}}},{key:"onPointerMove",value:function(t,e){var n=t.touches,o=d(e,2),r=o[0],i=o[1],a=this.isEnabled,c=this.pointer,s=this.rect;if(a){if(n){for(var u=s.top,l=s.left,f=i=r=0;f<n.length;f+=1){var h=n[f];r+=h.clientX-l,i+=h.clientY-u}r/=n.length,i/=n.length}var p=s.width,y=s.height;c.current.x=r,c.current.y=i,c.normalized.x=r/p*2-1,c.normalized.y=1-i/y*2,c.movement={x:c.current.x-c.last.x,y:c.current.y-c.last.y},c.last.copy(c.current)}}},{key:"onPointerUp",value:function(t){var e=t.button,n=t.touches,o=this.isEnabled,r=this.pointer;if(o){if(n)return r.primary&&(r.primary=!1,r.primaryUp=!0),void(r.secondary&&(r.secondary=!1,r.secondaryUp=!0));switch(e){case 0:r.primary=!1,r.primaryUp=!0;break;case 2:r.secondary=!1,r.secondaryUp=!0}}}},{key:"onPointerWheel",value:function(t){var e=t.deltaY,n=this.isEnabled,o=this.pointer;n&&(o.wheel=e)}},{key:"onResize",value:function(){var t=this.mount;this.rect=t.getBoundingClientRect()}}])&&c(t.prototype,e),n&&c(t,n),o}();e.a=s},gaOq:function(t,e,n){"use strict";n.r(e);var O=n("Womt"),i=n("xeez");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var r=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=c(this,s(e).call(this,new i.a({width:512,height:64,depthTest:!1})))).scale.set(3,.375,1),t.visible=!1,t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,O["W"]),n=e,(o=[{key:"display",value:function(t){var e=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1500,o=this.material,r=o.renderer,i=o.ctx,a=r.width,c=r.height;i.clearRect(0,0,a,c),i.fillStyle="#fff",i.textAlign="center",i.textBaseline="middle",i.shadowColor="rgba(0, 0, 0, 0.5)",i.shadowBlur=10,i.font="24px 'Print Char 21',monospace",i.fillText(t.shift(),.5*a,.5*c),this.material.map.needsUpdate=!0,this.visible=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){t.length?e.display(t,n):e.visible=!1},n)}}])&&a(n.prototype,o),r&&a(n,r),e}();function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function h(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var y=function(t){function d(t){var n,e,o,r=t.bonesOrigin,i=t.collisionGeometry,a=t.geometry,c=t.material;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,d),e=this,o=v(d).call(this,a,c),n=!o||"object"!==b(o)&&"function"!=typeof o?w(e):o;var s=new O.d;n.add(s);var u=new O.d;s.add(u);var l=new O.d;u.add(l);var f=new O.d;u.add(f);var h=new O.d;u.add(h);var p=new O.d;s.add(p);var y=new O.d;return s.add(y),n.bind(new O.S([s,u,l,f,h,p,y])),Object.keys(r).forEach(function(t){n.skeleton.bones[d.Bones[t]].position.copy(r[t])}),n.mixer=new O.c(w(w(n))),n.actions=Object.keys(d.animations).reduce(function(t,e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(t){m(e,t,n[t])})}return e}({},t,m({},e,n.mixer.clipAction(d.animations[e])))},{}),n.animation="idle",n.actions.idle.timeScale=.5,n.actions.idle.play(),n.rotationAux=new O.Z,n.movementAux=new O.ab,n.collisionMesh=new O.z(i,new O.A({opacity:.1,transparent:!0,visible:!1,wireframe:!0})),n.add(n.collisionMesh),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(d,O["T"]),h(d,null,[{key:"geometryFromLimbs",value:function(t){var n=new O.t;Object.keys(t).forEach(function(e){t[e].faces.forEach(function(t){t.materialIndex=d.Bones[e]}),n.merge(t[e])}),n.faces.forEach(function(t){n.vertices[t.a].bone=t.materialIndex,n.vertices[t.b].bone=t.materialIndex,n.vertices[t.c].bone=t.materialIndex,t.materialIndex=0}),n.vertices.forEach(function(t){n.skinIndices.push(new O.bb(t.bone,0,0,0)),n.skinWeights.push(new O.bb(1,0,0,0))});var e=(new O.h).fromGeometry(n);return e.computeVertexNormals(),e.computeBoundingSphere(),e}}]),h(d,[{key:"onAnimationTick",value:function(t){var e=t.delta,n=this.actions.walk.timeScale,o=this.destinationMarker,r=this.mixer,i=this.movementAux,a=this.onDestinationCallback,c=this.position,s=this.rotationSpeed,u=this.route,l=this.targetRotation;if(r.update(e),void 0!==l){var f=e*s,h=l-this.rotation.y;this.rotation.y+=Math.min(Math.max(h,-f),f),Math.abs(h)<=f&&delete this.targetRotation}if(u){var p=u.path[u.current],y=c.distanceTo(p),d=1.5*e*n;if(c.add(i.copy(p).sub(c).normalize().multiplyScalar(Math.min(y,d))),!(d<y)){if(u.current<u.path.length-1)return u.current+=1,void this.faceTo(u.path[u.current]);this.setAnimation("idle"),delete this.route,o&&(o.visible=!1),a&&(delete this.onDestinationCallback,a())}}}},{key:"setAnimation",value:function(t){var e=this.actions;this.animation!==t&&(e[this.animation].fadeOut(.2),this.animation=t,e[this.animation].reset().fadeIn(.2).play())}},{key:"walk",value:function(t,e){var n=this.destinationMarker,o=this.position.distanceTo(t[t.length-1]);delete this.onDestinationCallback,0!==o?(this.setAnimation("walk"),this.route={current:0,path:t},n&&(n.position.copy(t[t.length-1]),n.visible=!0),e&&(this.onDestinationCallback=e),this.faceTo(t[0])):e&&e()}},{key:"faceTo",value:function(t){for(var e=this.position,n=this.rotationAux.set(t.x-e.x,t.z-e.z).angle();this.rotation.y<-Math.PI;)this.rotation.y+=2*Math.PI;for(;this.rotation.y>Math.PI;)this.rotation.y-=2*Math.PI;for(this.targetRotation=.5*Math.PI-n;this.targetRotation<-Math.PI;)this.targetRotation+=2*Math.PI;for(;this.targetRotation>Math.PI;)this.targetRotation-=2*Math.PI;this.targetRotation-this.rotation.y>Math.PI?this.targetRotation-=2*Math.PI:this.targetRotation-this.rotation.y<-Math.PI&&(this.targetRotation+=2*Math.PI),this.rotationSpeed=1.5*Math.abs(this.targetRotation-this.rotation.y)}},{key:"say",value:function(t,e){this.bubble||(this.bubble=new r,this.bubble.position.set(0,2.25*this.geometry.boundingSphere.radius,0),this.add(this.bubble)),this.bubble.display(t,e)}}]),d}();y.Bones={hip:0,torso:1,head:2,leftArm:3,rightArm:4,leftLeg:5,rightLeg:6};var d=function(t,e,n){return(new O.L).setFromEuler(new O.r(t,e,n)).toArray()};y.animations={idle:new O.b("idle",1,[new O.M(".bones[".concat(y.Bones.torso,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(l(d(0,-.05*Math.PI,0)).concat(l(d(0,.05*Math.PI,0)),l(d(0,-.05*Math.PI,0))))),new O.M(".bones[".concat(y.Bones.head,"].quaternion"),new Float32Array([0,.75,1]),new Float32Array(l(d(-.075*Math.PI,0,-.025*Math.PI)).concat(l(d(-.075*Math.PI,0,.025*Math.PI)),l(d(-.075*Math.PI,0,-.025*Math.PI))))),new O.M(".bones[".concat(y.Bones.leftArm,"].quaternion"),new Float32Array([0,.75,1]),new Float32Array(l(d(0,0,-.05*Math.PI)).concat(l(d(0,0,-.1*Math.PI)),l(d(0,0,-.05*Math.PI))))),new O.M(".bones[".concat(y.Bones.rightArm,"].quaternion"),new Float32Array([0,.25,1]),new Float32Array(l(d(0,0,.05*Math.PI)).concat(l(d(0,0,.1*Math.PI)),l(d(0,0,.05*Math.PI)))))]),walk:new O.b("walk",1,[new O.M(".bones[".concat(y.Bones.torso,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(l(d(-.02*Math.PI,0,.01*Math.PI)).concat(l(d(.02*Math.PI,0,-.01*Math.PI)),l(d(-.02*Math.PI,0,.01*Math.PI))))),new O.M(".bones[".concat(y.Bones.head,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(l(d(0,0,-.025*Math.PI)).concat(l(d(0,0,.025*Math.PI)),l(d(0,0,-.025*Math.PI))))),new O.M(".bones[".concat(y.Bones.leftArm,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(l(d(.1*Math.PI,0,0)).concat(l(d(-.1*Math.PI,0,-.1*Math.PI)),l(d(.1*Math.PI,0,0))))),new O.M(".bones[".concat(y.Bones.rightArm,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(l(d(-.1*Math.PI,0,.1*Math.PI)).concat(l(d(.1*Math.PI,0,0)),l(d(-.1*Math.PI,0,.1*Math.PI))))),new O.M(".bones[".concat(y.Bones.leftLeg,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(l(d(-.15*Math.PI,0,.01*Math.PI)).concat(l(d(.15*Math.PI,0,-.01*Math.PI)),l(d(-.15*Math.PI,0,.01*Math.PI))))),new O.M(".bones[".concat(y.Bones.rightLeg,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(l(d(.15*Math.PI,0,-.01*Math.PI)).concat(l(d(-.15*Math.PI,0,.01*Math.PI)),l(d(.15*Math.PI,0,-.01*Math.PI)))))])};var g=y;function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,e){return(j=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),k(this,S(e).call(this,{bonesOrigin:e.bones,collisionGeometry:new O.n(.25,.25,1.4).translate(0,.7,0),geometry:e.geometry(t),material:e.material}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&j(t,e)}(e,g),e}();_.bones={hip:new O.ab(0,.5,0),torso:new O.ab(0,0,0),head:new O.ab(0,.49,0),leftArm:new O.ab(-.15,.475,0),rightArm:new O.ab(.15,.475,0),leftLeg:new O.ab(-.075,0,0),rightLeg:new O.ab(.075,0,0)},_.geometry=function(e){var t=new O.o(.175,.15,.5,6);t.translate(0,.25,0),t.faces.forEach(function(t){t.color.set(e.torso||10027008)});var n=new O.V(.2,8,4);if(n.translate(0,.2,0),n.faces.forEach(function(t){t.color.set(e.head)}),e.hat){var o=new O.o(.3,.3,.05),r=new O.o(.2,.2,.3);r.translate(0,.15,0),o.merge(r),o.translate(0,.3,0),o.faces.forEach(function(t){t.color.set(e.hat)}),n.merge(o)}var i=new O.V(.05);i.faces.forEach(function(t){t.color.set(e.eyes)});var a=i.clone();i.translate(-.1,.2,.15),a.translate(.1,.2,.15),n.merge(i),n.merge(a);var c=new O.o(.05,.03,.4,6);c.faces.forEach(function(t){t.color.set(e.arms)});var s=c.clone();c.translate(0,-.2,0),s.translate(0,-.2,0);var u=new O.o(.05,.05,.5,4);u.faces.forEach(function(t){t.color.set(e.legs)});var l=u.clone();u.translate(0,-.25,0),l.translate(0,-.25,0);var f=g.geometryFromLimbs({torso:t,head:n,leftArm:c,rightArm:s,leftLeg:u,rightLeg:l});return f.boundingSphere.center.set(0,.7,0),f.boundingSphere.radius=.7,f},_.material=new O.C({skinning:!0,vertexColors:O.db});var x=_;function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function A(t,e){return!e||"object"!==M(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var B=function(t){function n(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=new O.j(.25,24);return e.rotateX(-.5*Math.PI),e.translate(0,.001,0),(t=A(this,T(n).call(this,e,new O.C({color:2236962,transparent:!0})))).visible=!1,t}var e,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(n,O["z"]),e=n,(o=[{key:"onAnimationTick",value:function(t){var e=t.time,n=this.material,o=this.scale;if(this.visible){var r=.125*(1+Math.sin(4*e)),i=.75+r;o.set(i,1,i),n.opacity=.25+r}}}])&&E(e.prototype,o),r&&E(e,r),n}();function C(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function z(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var F=function(t){var r=t.input,i=t.scene,a={dudes:z(Array(13)).map(function(t,e){var n=new x({arms:2236962,eyes:0===e?10027008:10066329*Math.random(),head:0===e?3355443:10066329*Math.random(),hat:.5<Math.random()&&10066329*Math.random(),legs:2236962,torso:0===e?10027008:10066329*Math.random()});return n.position.set(Math.floor((e+1)/2)*((e+1)%2==0?1:-1),0,0),i.root.add(n),n}),onAnimationTick:function(){var t=i.camera,e=i.grid,n=r.getPointerFrame();if(t.processPointer(n),n.primaryUp){var o=t.getRaycaster(n.normalized).intersectObject(e)[0];if(!o)return;a.walkTo(o.point)}},walkTo:function(n){var o=n.x,r=n.z;this.dudes.forEach(function(t,e){n.x=o+Math.floor((e+1)/2)*((e+1)%2==0?1:-1),n.z=r+-1*Math.floor((e+1)/2),0<e&&(n.x+=2*Math.random()-1,n.z+=2*Math.random()-1,t.actions.walk.timeScale=.8+.4*Math.random()),t.walk([n.clone()])})}},e=C(a.dudes,1)[0];e.destinationMarker=new B,i.root.add(e.destinationMarker),i.camera.target=e.position,i.camera.minHeight=.1,i.camera.distance=6,i.camera.pitch=.125*Math.PI,i.camera.updateOrbit(),i.onAnimationTick=a.onAnimationTick.bind(a)},R=n("16wW"),D=n.n(R),L=n("bUov"),G=n.n(L),N=n("kw1J"),H=n.n(N),U=n("vV97");function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function K(t,e){return(K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var X=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),V(this,q(e).call(this,{bonesOrigin:e.bones,collisionGeometry:new O.n(.25,.25,1.4).translate(0,.7,0),geometry:e.geometry(t),material:e.material}))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(e,g),e}();X.bones={hip:new O.ab(0,.4,0),torso:new O.ab(0,0,0),head:new O.ab(0,.5,0),leftArm:new O.ab(-.325,.45,0),rightArm:new O.ab(.325,.45,0),leftLeg:new O.ab(-.08,.1,0),rightLeg:new O.ab(.08,.1,0)},X.geometry=function(e){var t=new O.V(.26,8,8);t.translate(0,.25,0),t.scale(1.5,1,1.5),t.faces.forEach(function(t){t.color.set(e.torso||10027008)});var n=new O.o(.175,.15,.4,6);if(n.translate(0,.2,0),n.faces.forEach(function(t){t.color.set(e.head)}),e.hat){var o=new O.o(.3,.3,.05),r=new O.o(.2,.2,.3);r.translate(0,.15,0),o.merge(r),o.translate(0,.3,0),o.faces.forEach(function(t){t.color.set(e.hat)}),n.merge(o)}var i=new O.V(.05);i.faces.forEach(function(t){t.color.set(e.eyes)});var a=i.clone();i.translate(-.1,.2,.15),a.translate(.1,.2,.15),n.merge(i),n.merge(a);var c=new O.o(.03,.075,.3,6);c.faces.forEach(function(t){t.color.set(e.arms)});var s=c.clone();c.translate(0,-.15,0),s.translate(0,-.15,0);var u=new O.o(.05,.1,.5,4);u.faces.forEach(function(t){t.color.set(e.legs)});var l=u.clone();u.translate(0,-.25,0),l.translate(0,-.25,0);var f=g.geometryFromLimbs({torso:t,head:n,leftArm:c,rightArm:s,leftLeg:u,rightLeg:l});return f.boundingSphere.center.set(0,.7,0),f.boundingSphere.radius=.7,f},X.material=new O.C({skinning:!0,vertexColors:O.db});var Y=X,J=n("seR1");function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function $(t,e){return!e||"object"!==Q(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nt=function(t){function r(t){var e,n=t.color;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var o=new O.e(1,1.9,.2);return o.translate(0,.95,0),(e=$(this,tt(r).call(this,o,new J.a({color:n})))).geometries={xAxis:o,yAxis:o.clone()},e.geometries.yAxis.rotateY(.5*Math.PI),e.timeOffset=100*Math.random(),e}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(r,O["z"]),e=r,(n=[{key:"onAnimationTick",value:function(t){var e=t.time,n=this.position,o=this.timeOffset,r=1-Math.max(Math.sin(2*e+o),0);this.scale.set(1,r,1),n.y=1.9*(1-r)}},{key:"yAxis",get:function(){return this._yAxis||!1},set:function(t){this.yAxis!==(this._yAxis=t)&&(this.geometry=this.geometries[t?"yAxis":"xAxis"])}}])&&Z(e.prototype,n),o&&Z(e,o),r}();function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function it(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function at(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ut(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var lt=function(t){function R(){var b,t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{number:0},o=n.grid,r=n.number;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,R),t=this,e=ct(R).call(this),(b=!e||"object"!==ot(e)&&"function"!=typeof e?ut(t):e).setNumber(r),b.entities=new O.E,b.entities.position.set(0,.1,0),b.add(b.entities);var i=R.defaultGridSize,a=i.width,c=i.height;b.grid=new U.Grid(a,c),b.grid.setTile=function(t){var e=t.color,n=t.type,o=t.x,r=t.y,i=ut(ut(b)),a=i.entities,c=i.grid.nodes[r][o],s=a.children.findIndex(function(t){var e=t.spawn;return o===e.x&&r===e.y});switch(~s&&a.remove(a.children[s]),c.color=e,c.type=n,c.walkable=n!==R.tiles.tile,n){case R.tiles.dude:case R.tiles.thiccboi:var u;switch(n){case R.tiles.dude:u=x;break;case R.tiles.thiccboi:u=Y}var l=new u({arms:2236962,eyes:10066329*Math.random(),hat:.5<Math.random()&&10066329*Math.random(),head:10066329*Math.random(),legs:2236962,torso:10066329*Math.random()});l.spawn={x:o,y:r},l.position.set(o+.5,0,r+.5),a.add(l);break;case R.tiles.door:var f=e.r,h=e.g,p=e.b,y=(f+h+p)/3;f+=.3*y,h+=.3*y,p+=.3*y;var d=new nt({color:(new O.m).setRGB(f,h,p)});d.spawn={x:o,y:r},d.position.set(o+.5,0,r+.5),a.add(d)}};for(var s=0;s<c;s+=1)for(var u=0;u<a;u+=1)if(o){var l=it(o[s][u],4),f=l[0],h=l[1],p=l[2],y=l[3];b.grid.setTile({x:u,y:s,type:f,color:(new O.m).setRGB(h/255,p/255,y/255)})}else b.grid.setTile({x:u,y:s,type:R.tiles.air,color:new O.m(0)});var d=new O.H(a,c,2,2);d.rotateX(-.5*Math.PI),d.translate(.5*a,0,.5*c);var m=new O.z(d,new O.A({side:O.q,transparent:!0,visible:!1}));b.add(m),b.intersect=[m];var v=new J.a({vertexColors:O.db});b.chunks=rt(Array(Math.ceil(b.grid.height/R.chunkSize.height))).map(function(){return rt(Array(Math.ceil(b.grid.width/R.chunkSize.width))).map(function(){var t=new O.h;t.setIndex(new O.g(new Uint16Array,1)),t.addAttribute("position",new O.g(new Float32Array,3)),t.addAttribute("color",new O.g(new Float32Array,3)),t.addAttribute("normal",new O.g(new Float32Array,3));var e=new O.z(t,v);return e.visible=!1,b.add(e),b.intersect.push(e),e})});for(var w=0;w<b.chunks.length;w+=1)for(var g=0;g<b.chunks[0].length;g+=1)b.updateChunk(g,w);return b}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(R,O["E"]),e=R,(n=[{key:"setNumber",value:function(t){this.number=t,this.position.set(0,R.height*t,0)}},{key:"setTile",value:function(t){var e=t.color,n=t.type,o=t.x,r=t.y,i=this.chunks,a=this.grid;if(!(o<0||o>a.width-1||r<0||r>a.height-1)){var c=((e=new O.m(e||0)).r+e.g+e.b)/3*.1;e.offsetHSL(Math.random()*(2*c)-c,Math.random()*(2*c)-c,Math.random()*(2*c)-c),a.setTile({color:e,type:n,x:o,y:r});for(var s=Math.floor(o/R.chunkSize.width),u=Math.floor(r/R.chunkSize.height),l=Math.max(u-1,0);l<=Math.min(r+1,i.length-1);l+=1)for(var f=Math.max(s-1,0);f<=Math.min(o+1,i[0].length-1);f+=1)this.updateChunk(f,l)}}},{key:"testTile",value:function(t,e,n){var o=this.grid;return!(t<0||t>o.width-1||e<0||e>o.height-1)&&-1!==n.indexOf(o.getNodeAt(t,e).type)}},{key:"updateChunk",value:function(t,e){for(var n,o,r,i,a,c,s=this,u=this.chunks,l=this.entities,f=this.grid,v=this.number,h=[],p=[],y=[],d=[],w=function(t,e,n){var o=p.length/3;p.push.apply(p,rt(t)),y.push.apply(y,rt(e)),d.push.apply(d,rt(n)),h.push(o,o+1,o+2,o+2,o+3,o)},b=function(t,e,n,o,r,i,a,c){var s=i.r,u=i.g,l=i.b,f=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,h=t+.5,p=e+.5,y=.5*n,d=.5*o,b=.8+.2*f/R.height,m=.8+.2*(f+r)/R.height;a(t,e+1)||w([h-y,f,p+d,h+y,f,p+d,h+y,f+r,p+d,h-y,f+r,p+d],[s*b,u*b,l*b,s*b,u*b,l*b,s*m,u*m,l*m,s*m,u*m,l*m],[0,0,1,0,0,1,0,0,1,0,0,1]),a(t,e-1)||w([h+y,f,p-d,h-y,f,p-d,h-y,f+r,p-d,h+y,f+r,p-d],[s*b,u*b,l*b,s*b,u*b,l*b,s*m,u*m,l*m,s*m,u*m,l*m],[0,0,-1,0,0,-1,0,0,-1,0,0,-1]),a(t-1,e)||w([h-y,f,p-d,h-y,f,p+d,h-y,f+r,p+d,h-y,f+r,p-d],[s*b,u*b,l*b,s*b,u*b,l*b,s*m,u*m,l*m,s*m,u*m,l*m],[1,0,0,1,0,0,1,0,0,1,0,0]),a(t+1,e)||w([h+y,f,p+d,h+y,f,p-d,h+y,f+r,p-d,h+y,f+r,p+d],[s*b,u*b,l*b,s*b,u*b,l*b,s*m,u*m,l*m,s*m,u*m,l*m],[-1,0,0,-1,0,0,-1,0,0,-1,0,0]),(0<v||0!==f)&&w([h-y,f+.001,p-d,h+y,f+.001,p-d,h+y,f+.001,p+d,h-y,f+.001,p+d],[.6*s,.6*u,.6*l,.6*s,.6*u,.6*l,.6*s,.6*u,.6*l,.6*s,.6*u,.6*l],[0,-1,0,0,-1,0,0,-1,0,0,-1,0]),w([h-y,f+r,p+d,h+y,f+r,p+d,h+y,f+r,p-d,h-y,f+r,p-d],[s*c[0],u*c[0],l*c[0],s*c[1],u*c[1],l*c[1],s*c[2],u*c[2],l*c[2],s*c[3],u*c[3],l*c[3]],[0,1,0,0,1,0,0,1,0,0,1,0])},m=function(t,e){return s.testTile(t,e,[R.tiles.tile,R.tiles.wall,R.tiles.window,R.tiles.fence,R.tiles.door,R.tiles.dude,R.tiles.thiccboi])},g=function(t,e){return s.testTile(t,e,[R.tiles.wall])},O=function(t,e){return s.testTile(t,e,[R.tiles.wall,R.tiles.window])},P=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.2;return s.testTile(t,e,[R.tiles.wall,R.tiles.window,R.tiles.fence])?n:0},k=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.2;return s.testTile(t,e,[R.tiles.wall])?n:0},S=function(t,e,n){return b(t,e,1,1,.1,n,m,[1-Math.min(P(t,e+1)+P(t-1,e)+P(t-1,e+1,.1),.4),1-Math.min(P(t,e+1)+P(t+1,e)+P(t+1,e+1,.1),.4),1-Math.min(P(t,e-1)+P(t+1,e)+P(t+1,e-1,.1),.4),1-Math.min(P(t,e-1)+P(t-1,e)+P(t-1,e-1,.1),.4)])},j=function(n,o,t){S(n,o,t),b(n,o,1,1,R.height*(1/3),t,O,[1,1,1,1],R.height*(1/3)*2),l.children[l.children.findIndex(function(t){var e=t.spawn;return n===e.x&&o===e.y})].yAxis=s.testTile(n,o+1,[R.tiles.wall,R.tiles.door])&&s.testTile(n,o-1,[R.tiles.wall,R.tiles.door])},_=function(t,e,n){b(t,e,1,1,R.height*(1/3),n,O,[1-Math.min(k(t,e+1)+k(t-1,e)+k(t-1,e+1,.1),.4),1-Math.min(k(t,e+1)+k(t+1,e)+k(t+1,e+1,.1),.4),1-Math.min(k(t,e-1)+k(t+1,e)+k(t+1,e-1,.1),.4),1-Math.min(k(t,e-1)+k(t-1,e)+k(t-1,e-1,.1),.4)])},x=e*R.chunkSize.height;x<Math.min((e+1)*R.chunkSize.height,f.height);x+=1)for(var M=t*R.chunkSize.width;M<Math.min((t+1)*R.chunkSize.width,f.width);M+=1){var E=f.getNodeAt(M,x);switch(E.type){case R.tiles.air:break;case R.tiles.wall:i=M,a=x,c=E.color,b(i,a,1,1,R.height,c,g,[1,1,1,1]);break;case R.tiles.window:n=M,o=x,r=E.color,_(n,o,r),b(n,o,1,1,R.height*(1/3),r,O,[1,1,1,1],R.height*(1/3)*2);break;case R.tiles.fence:_(M,x,E.color);break;case R.tiles.door:j(M,x,E.color);break;default:S(M,x,E.color)}}var A=u[e][t],T=A.geometry,I=T.getIndex(),C=T.getAttribute("position"),z=T.getAttribute("color"),F=T.getAttribute("normal");I.setArray(new Uint16Array(h)),I.needsUpdate=!0,C.setArray(new Float32Array(p)),C.needsUpdate=!0,z.setArray(new Float32Array(y)),z.needsUpdate=!0,F.setArray(new Float32Array(d)),F.needsUpdate=!0,T.computeBoundingSphere(),A.visible=!!C.count}}])&&at(e.prototype,n),o&&at(e,o),R}();lt.height=3,lt.tiles={air:0,tile:1,wall:2,window:3,fence:4,door:5,dude:6,thiccboi:7},lt.defaultGridSize={width:48,height:48},lt.chunkSize={width:16,height:16};var ft=lt;function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function yt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function bt(t){return(bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vt=function(t){function n(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(e=dt(this,bt(n).call(this))).floors=t.floors?t.floors.map(function(t,e){return new ft({grid:t,number:e})}):[new ft],e.floors.forEach(function(t){return e.add(t)}),e.activeFloor=0,e.computeHeightmap(),e}var e,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(n,O["E"]),e=n,(o=[{key:"onAnimationTick",value:function(e){this.floors.forEach(function(t){return t.entities.children.forEach(function(t){return t.onAnimationTick(e)})})}},{key:"computeHeightmap",value:function(){var t=this.floors,a=[];t.forEach(function(t,i){return t.grid.nodes.forEach(function(t){return t.forEach(function(t){var e,n=t.x,o=t.y,r=t.type;switch(a[o]||(a[o]=[]),r){case ft.tiles.tile:e=3*i+.1;break;case ft.tiles.wall:case ft.tiles.window:e=3*(i+1);break;default:e=0}a[o][n]=Math.max(a[o][n]||0,e)})})}),this.heightmap=a}},{key:"getHeight",value:function(t,e){var n=this.heightmap;return t=Math.floor(t),e=Math.floor(e),t<0||t>n[0].length-1||e<0||e>n.length-1?0:n[e][t]}},{key:"export",value:function(){return{floors:this.floors.map(function(t){return t.grid.nodes.map(function(t){return t.map(function(t){var e=t.type,n=t.color;return[255&e,255&Math.floor(255*n.r),255&Math.floor(255*n.g),255&Math.floor(255*n.b)]})})})}}},{key:"addFloor",value:function(){var t=this.floors,e=this.activeFloor,n=new ft({number:e+1});t.splice(e+1,0,n),this.add(n);for(var o=e+1;o<t.length;o+=1)t[o].setNumber(o);this.activeFloor+=1}},{key:"removeFloor",value:function(){var t=this.floors,e=this.activeFloor,n=pt(t.splice(e,1),1)[0];this.remove(n),t.length||this.addFloor(),t[e]||(this.activeFloor-=1);for(var o=e;o<t.length;o+=1)t[o].setNumber(o)}}])&&yt(e.prototype,o),r&&yt(e,r),n}();function wt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var gt=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.wrapper=document.createElement("div"),this.wrapper.className=t,this.content=document.createElement("div"),this.wrapper.appendChild(this.content)}var t,n,o;return t=e,(n=[{key:"mount",value:function(){var t=this.wrapper;document.body.appendChild(t)}},{key:"unmount",value:function(){var t=this.wrapper;document.body.removeChild(t)}},{key:"add",value:function(t,e){var n=this.content,o=document.createElement(t);return e&&(o.className=e),n.appendChild(o),o}},{key:"empty",value:function(){for(var t=this.content;t.firstChild;)t.removeChild(t.firstChild)}}])&&wt(t.prototype,n),o&&wt(t,o),e}();function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function kt(t,e,n){return(kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}(t,e);if(o){var r=Object.getOwnPropertyDescriptor(o,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function St(t){return(St=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jt(t,e){return(jt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _t(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var xt=function(t){function O(t){var o,e,n,r=t.floorCount,i=t.onAddFloor,a=t.onRemoveFloor,c=t.onSave,s=t.onSetFloor;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,O),e=this,n=St(O).call(this,"toolbar"),(o=!n||"object"!==Ot(n)&&"function"!=typeof n?_t(e):n).onKeyup=o.onKeyup.bind(_t(_t(o))),o.onSetFloor=s,o.add("label").innerText="Floor";var u=o.add("input");u.type="number",u.addEventListener("change",function(t){var e=t.target.value;o.setFloor(parseInt(e,10))},!1),u.min=0,u.step=1,o.floorInput=u;var l=o.add("div"),f=o.add("button");f.innerText="+",f.addEventListener("click",i,!1);var h=o.add("button");h.innerText="Ã—",h.addEventListener("click",a,!1),l.appendChild(f),l.appendChild(h);var p=o.add("div");p.appendChild(u),p.appendChild(l),o.add("label").innerText="Color";var y=o.add("input");y.type="color",y.addEventListener("change",function(t){var e=t.target.value;o.setColor(e)},!1),o.colorInput=y;var d=o.add("button");d.innerText="Pick",d.addEventListener("click",function(){var t=o.tool,e=t.tool,n=t.modifier;o.setTool("pick","paint"===e?n:1)},!1),o.pickButton=d;var b=o.add("div");b.appendChild(y),b.appendChild(d);var m=["Air","Tile","Wall","Window","Fence","Door","Dude","ThiccBoi"].map(function(t,e){var n=o.add("button");return n.innerText=t,n.addEventListener("click",function(){o.setTool("paint",e)},!1),n});o.add("label").innerText="Tiles";var v=o.add("div");m.slice(0,6).forEach(function(t){return v.appendChild(t)}),o.add("label").innerText="Actors";var w=o.add("div");m.slice(6).forEach(function(t){return w.appendChild(t)}),o.tiles=m;var g=o.add("button");return g.className="save",g.innerText="Save",g.addEventListener("click",c,!1),o.saveButton=g,o.setFloorCount(r),o.setFloor(0),o.setTool("paint",1),o.setColor("#aaaaaa"),o.mount(),o}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jt(t,e)}(O,gt),e=O,(n=[{key:"mount",value:function(){kt(St(O.prototype),"mount",this).call(this),window.addEventListener("keyup",this.onKeyup,!1)}},{key:"unmount",value:function(){kt(St(O.prototype),"unmount",this).call(this),window.removeEventListener("keyup",this.onKeyup)}},{key:"onKeyup",value:function(t){var e=t.keyCode;t.repeat||49<=e&&e<=57&&this.setTool("paint",e-49)}},{key:"setColor",value:function(t){this.colorInput.value=t,this.color=t}},{key:"setFloorCount",value:function(t){this.floorInput.max=t-1,this.floorCount=t}},{key:"setFloor",value:function(t){this.floorInput.value=t,this.floor=t,this.onSetFloor(t)}},{key:"setModified",value:function(t){this.saveButton.className="save".concat(t?" modified":"")}},{key:"setTool",value:function(t,e){var n=this.pickButton,o=this.tiles;switch(this.tool={tool:t,modifier:e},o.forEach(function(t){t.className=""}),n.className="",t){case"paint":o[e].className="active";break;case"pick":n.className="active"}}}])&&Pt(e.prototype,n),o&&Pt(e,o),O}();function Mt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var Et=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.past=[],this.future=[]}var e,n,o;return e=t,(n=[{key:"empty",value:function(){var t=this.past,e=this.future;t.length=0,e.length=0}},{key:"undo",value:function(){var t=this.past,e=this.future,n=t.pop();n&&(n.undo(),e.unshift(n))}},{key:"redo",value:function(){var t=this.past,e=this.future.shift();e&&(e.redo(),t.push(e))}},{key:"push",value:function(t){var e=t.undo,n=t.redo,o=this.past,r=this.future;o.push({undo:e,redo:n}),r.length=0}}])&&Mt(e.prototype,n),o&&Mt(e,o),t}();function At(t){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Tt(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function It(t,e){return!e||"object"!==At(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function zt(t,e){return(zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ft=function(t){function a(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.color,o=void 0===n?16777215:n,r=Tt(e,["color"]);!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var i=O.Q.basic.vertexShader.replace("#include <clipping_planes_pars_vertex>",["#include <clipping_planes_pars_vertex>","attribute vec3 offset;"].join("\n")).replace("#include <begin_vertex>",["vec3 transformed = vec3(position + offset);"].join("\n"));return(t=It(this,Ct(a).call(this,function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},e=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.forEach(function(t){var e,n,o;e=r,o=i[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return r}({name:"rain-material",uniforms:O.Y.clone(O.Q.basic.uniforms),fragmentShader:O.Q.basic.fragmentShader,vertexShader:i,fog:!0},r)))).color=t.uniforms.diffuse.value,t.color.set(o),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zt(t,e)}(a,O["R"]),a}();function Rt(t){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Lt(t,e){return!e||"object"!==Rt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Gt(t){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nt=function(t){function u(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),t=Lt(this,Gt(u).call(this));var e=new Float32Array(3*u.numDrops),n=new O.h;n.addAttribute("position",new O.g(e,3).setDynamic(!0));var o=new O.J(n,new O.K({color:11184861,fog:!0,size:.01,sizeAttenuation:!0,transparent:!0,opacity:1/3}));o.frustumCulled=!1,o.offsets=e,t.add(o),t.ripples=o;var r=(new O.h).fromGeometry(new O.f(.01,.5,.01).translate(0,.25,0)).attributes.position.array,i=new Float32Array(3*u.numDrops),a=new O.v;a.addAttribute("position",new O.g(r,3)),a.addAttribute("offset",new O.u(i,3).setDynamic(!0));var c=new O.z(a,new Ft({color:11184861}));c.frustumCulled=!1,c.drop=new O.ab,c.offsets=i,t.add(c),t.drops=c;for(var s=0;s<3*u.numDrops;s+=3)t.resetDrop(s),t.ripples.offsets[s]=0,t.ripples.offsets[s+1]=-999,t.ripples.offsets[s+2]=0;return t}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(u,O["E"]),e=u,(n=[{key:"onAnimationTick",value:function(t){for(var e=t.delta,n=this.drops,o=this.position,r=this.ripples,i=n.offsets,a=16*e,c=0;c<3*u.numDrops;c+=3){i[c+1]-=a;var s=0;this.testHeight&&(s=this.testHeight(i[c]+o.x,i[c+2]+o.z)),i[c+1]<=s&&(i[c+1]=s,this.resetDrop(c))}n.geometry.attributes.offset.needsUpdate=!0,r.geometry.attributes.position.needsUpdate=!0}},{key:"resetDrop",value:function(t){var e=this.drops,n=this.position,o=this.ripples,r=e.drop,i=e.offsets;r.set(Math.random()*(2*u.radius+1)-u.radius,0,Math.random()*(2*u.radius+1)-u.radius);var a=Math.random()*u.radius*.5;this.testHeight&&(a=Math.max(a,this.testHeight(r.x+n.x,r.z+n.z))),o.offsets[t]=i[t],o.offsets[t+1]=i[t+1]+.01,o.offsets[t+2]=i[t+2],i[t]=r.x,i[t+1]=a,i[t+2]=r.z}},{key:"setHeightTest",value:function(t){var e=this.drops,n=this.ripples;this.testHeight=t;for(var o=0;o<3*u.numDrops;o+=3)this.resetDrop(o);e.geometry.attributes.offset.needsUpdate=!0,n.geometry.attributes.position.needsUpdate=!0}}])&&Dt(e.prototype,n),o&&Dt(e,o),u}();Nt.numDrops=1e4,Nt.radius=50;var Ht=Nt;function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wt(t,e){return!e||"object"!==Ut(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Vt(t){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Wt(this,Vt(e).call(this,new O.U(100,32,32),new O.A({color:12500670,fog:!1})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(e,O["z"]),e}();function Xt(t){return(Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yt(t,e){return!e||"object"!==Xt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Jt(t){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Zt=function(t){function s(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);for(var e=1024,n=new O.h,o=new Float32Array(3e4),r=new Float32Array(1e4),i=new O.ab,a=0;a<1e4;a+=1){i.set(Math.floor(2049*Math.random())-e,Math.floor(1025*Math.random()),Math.floor(2049*Math.random())-e).normalize().multiplyScalar(e);var c=3*a;o[c]=i.x,o[c+1]=i.y,o[c+2]=i.z,r[a]=10+Math.floor(100*Math.random())}return n.addAttribute("position",new O.g(o,3)),n.addAttribute("size",new O.g(r,1)),(t=Yt(this,Jt(s).call(this,n,new O.K({color:10066329,fog:!1,sizeAttenuation:!1})))).moon=new Kt,t.moon.position.set(e,512,e),t.add(t.moon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qt(t,e)}(s,O["J"]),s}();var $t=function(t){var m=t.input,v=t.scene,e=new Ht;v.root.add(e);var n=new Zt;v.root.add(n);var o=localStorage.getItem("SpY::EditorTestLevel"),w=new vt(o?JSON.parse(G()(D.a.inflate(new Uint8Array(H()(o))))):{});v.root.add(w),e.position.x=.5*w.heightmap[0].length,e.position.z=.5*w.heightmap.length,e.setHeightTest(w.getHeight.bind(w)),v.camera.distance=10,v.camera.minHeight=.2,v.camera.updateOrbit();var r=w.floors[w.activeFloor].grid,i=r.width,a=r.height;v.camera.root.position.set(.5*i+.5,0,.5*a+.5),v.camera.maxDistance=32;var g=new Et;window.addEventListener("keydown",function(t){var e=t.ctrlKey,n=t.keyCode,o=t.shiftKey,r=t.target;e&&90===n&&!~["INPUT","TEXTAREA"].indexOf(r.tagName)&&(t.preventDefault(),t.stopPropagation(),o?g.redo():g.undo())});var O=new xt({floorCount:w.floors.length,onAddFloor:function(){w.addFloor(),O.setFloorCount(w.floors.length),O.setFloor(w.activeFloor)},onRemoveFloor:function(){window.confirm("Remove the current floor?")&&(w.removeFloor(),O.setFloorCount(w.floors.length),O.setFloor(w.activeFloor),g.empty())},onSave:function(){var t=w.export(),e=G()(D.a.deflate(new Uint8Array(H()(JSON.stringify(t)))),"base64");localStorage.setItem("SpY::EditorTestLevel",e),O.setModified(!1)},onSetFloor:function(t){w.activeFloor=t;var e=w.floors[w.activeFloor].constructor.height;v.camera.root.position.y=e*t}}),P={x:-1,y:-1};v.onAnimationTick=function(t){var e=t.delta,n=v.camera,o=m.getPointerFrame();if(n.processPointer(o),n.processKeyboard(function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},e=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.forEach(function(t){var e,n,o;e=r,o=i[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return r}({},m.keyboard,{delta:e})),o.primary){var r=n.getRaycaster(o.normalized),i=w.floors[w.activeFloor],a=r.intersectObjects(i.intersect)[0];if(a){a.point.addScaledVector(a.face.normal,-.5);var c=O.color,s=O.tool,u=s.tool,l=s.modifier,f=Math.floor(a.point.x),h=Math.floor(a.point.z);if(o.primaryDown||f!==P.x||h!==P.y){P.x=f,P.y=h;var p=i.grid.getNodeAt(f,h),y=p.type,d="#".concat(p.color.getHexString());switch(u){case"paint":var b={undo:function(){i.setTile({type:y,color:d,x:f,y:h}),w.computeHeightmap(),O.setModified(!0)},redo:function(){i.setTile({type:l,color:c,x:f,y:h}),w.computeHeightmap(),O.setModified(!0)}};b.redo(),g.push(b);break;case"pick":O.setColor(d),O.setTool("paint",l)}}}}}};function te(t){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ee(t,e){return!e||"object"!==te(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function ne(t){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function oe(t,e){return(oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var re=function(t){function a(t){var e=t.color,n=t.scale;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var o=new O.f(.998,.999,.998,n.x,n.y,n.z),r=new O.m;o.faces.forEach(function(t,e){e%2==0&&r.setHSL(Math.random(),.05,.25+.125*Math.random()),t.color.copy(r)}),o.translate(0,.5,0);for(var i=0;i<12;i+=1)o.faces.splice(40,1);return o.scale(n.x,n.y,n.z),ee(this,ne(a).call(this,(new O.h).fromGeometry(o),new O.C({color:e,side:O.q,vertexColors:O.db})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oe(t,e)}(a,O["z"]),a}();function ie(t){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ce(t,e){return!e||"object"!==ie(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function se(t){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var le=function(t){function i(t){var e,n=t.onTap,o=t.position;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var r=new O.e(.2,.15,.08);return r.translate(0,0,.039),(e=ce(this,se(i).call(this,r,new O.C({color:4456448})))).animation=0,e.animationVector=new O.ab(0,0,-.04),e.onTap=n,e.position.copy(o),e.origin=o.clone(),e}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(i,O["z"]),e=i,(n=[{key:"tap",value:function(){var t,e=this.onTap;return!this.tapping&&(e&&(t=e()),this.animation=0,this.tapping=!0,t)}},{key:"onAnimationTick",value:function(t){var e=t.delta,n=this.animationVector,o=this.origin;if(this.tapping){this.animation=Math.min(this.animation+.75*e,1),1===this.animation&&delete this.tapping;var r=O.y.smoothstep(2*(.5<this.animation?1-this.animation:this.animation),0,1);this.position.copy(o).addScaledVector(n,r)}}}])&&ae(e.prototype,n),o&&ae(e,o),i}();function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function he(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pe(t,e){return!e||"object"!==fe(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){return(de=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var be=function(t){function l(t){var e,n=t.color,o=t.onCall,r=t.scale;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),e=pe(this,ye(l).call(this));var i=new O.I(.5,1,.5*r.x,r.y),a=new O.m;i.faces.forEach(function(t,e){e%2==0&&a.setHSL(Math.random(),.05,.25+.125*Math.random()),t.color.copy(a)}),i.scale(r.x,r.y,r.z);for(var c=(new O.h).fromGeometry(i),s=0;s<2;s+=1){var u=new O.z(c,new O.C({color:n,side:O.q,vertexColors:O.db}));u.position.set((.52*s-.26)*r.x,.5*r.y,.499*r.z),e.add(u)}return e.animation=0,e.animationScale=r.x,e.state=l.states.CLOSED,e.targetState=e.state,e.callButton=new le({onTap:o,position:new O.ab(.6*r.x,1/3*r.y,.5*r.z)}),e.add(e.callButton),e.collisionMesh=new O.z(new O.H(1,1).scale(r.x,r.y,1).translate(0,.5*r.y,.5*r.z),new O.A({opacity:.1,transparent:!0,visible:!1,wireframe:!0})),e.add(e.collisionMesh),e}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&de(t,e)}(l,O["E"]),e=l,(n=[{key:"open",value:function(){this.state=l.states.MOVING,this.targetState=l.states.OPEN}},{key:"close",value:function(){this.state=l.states.MOVING,this.targetState=l.states.CLOSED}},{key:"toggle",value:function(){switch(this.state){case l.states.OPEN:this.close();break;case l.states.CLOSED:this.open()}}},{key:"onAnimationTick",value:function(t){var e=this.animationScale,n=this.children,o=this.state,r=this.targetState;if(this.callButton.onAnimationTick(t),o===l.states.MOVING){var i=.75*t.delta;switch(r){case l.states.OPEN:this.animation=Math.min(this.animation+i,1),1===this.animation&&(this.state=l.states.OPEN);break;case l.states.CLOSED:this.animation=Math.max(this.animation-i,0),0===this.animation&&(this.state=l.states.CLOSED)}for(var a=.4*O.y.smoothstep(this.animation,0,1),c=0;c<2;c+=1)n[c].position.x=(.52*c-.26+a*(0===c?-1:1))*e}}}])&&he(e.prototype,n),o&&he(e,o),l}();be.states={OPEN:0,CLOSED:1,MOVING:2};var me=be;function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function we(t,e){return!e||"object"!==ve(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function ge(t){return(ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Oe(t,e){return(Oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Pe=function(t){function u(t){var e=t.color,n=t.floors,o=t.scale;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var r=new O.t,i=0;i<=n;i+=1){if(0===i||i===n){var a=new O.I(1,1);if(a.rotateX(-.5*Math.PI),a.translate(0,i,0),r.merge(a),i===n)break}var c=new O.I(1,1);c.translate(0,i+.5,-.5),r.merge(c);var s=new O.I(1,1);s.rotateY(-.5*Math.PI),s.translate(-.5,i+.5,0),r.merge(s),s.translate(1,0,0),r.merge(s)}return r.scale(o.x,o.y,o.z),we(this,ge(u).call(this,(new O.h).fromGeometry(r),new O.C({color:e,side:O.q})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Oe(t,e)}(u,O["z"]),u}();function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Se(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function je(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function _e(t){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xe(t,e){return(xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Me(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ee=function(t){function c(t){var o,e,n,r=t.floors,i=t.origin;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),e=this,n=_e(c).call(this),(o=!n||"object"!==ke(n)&&"function"!=typeof n?Me(e):n).floors=r,o.origin=i,o.animationStart=512*Math.random(),o.shaft=new Pe({color:c.shaft,floors:r,scale:c.scale}),o.add(o.shaft),o.doors=Se(Array(r)).map(function(t,e){var n=new me({color:c.doors,onCall:function(){return o.onCall(e)},scale:c.scale});return n.collisionMesh.elevator=Me(Me(o)),n.position.y=e*c.scale.y,o.add(n),n}),o.cabin=new re({color:c.cabin,scale:c.scale}),o.add(o.cabin),o.position.z=-1.5*c.scale.z,o.floor=0,o.passengers=[],o}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xe(t,e)}(c,O["E"]),e=c,(n=[{key:"addPassenger",value:function(t){this.passengers.push(t)}},{key:"removePassenger",value:function(e){var t=this.passengers,n=t.findIndex(function(t){return t===e});~n&&t.splice(n,1)}},{key:"onAnimationTick",value:function(e){var n=this.cabin,t=this.doors,o=this.passengers,r=this.position,i=this.route;if(i){i.step+=.5*e.delta/Math.abs(i.travel),1<=i.step&&(i.step=1,t[i.to].open(),this.floor=i.to,delete this.route,i.callback&&i.callback());var a=O.y.smoothstep(i.step,0,1)*i.travel;n.position.y=(i.from+a)*c.scale.y,o.forEach(function(t){t.position.copy(n.position).add(r)})}t.forEach(function(t){return t.onAnimationTick(e)})}},{key:"onCall",value:function(t,e){var n=this.route,o=this.doors;n||(t!==this.floor?(o[this.floor].close(),this.route={callback:e,from:this.floor,to:t,travel:t-this.floor,step:0}):o[t].toggle())}}])&&je(e.prototype,n),o&&je(e,o),c}();Ee.scale=new O.ab(2,3,2),Ee.cabin=4456448,Ee.doors=3355443,Ee.shaft=3355443;var Ae=Ee;function Te(t){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ie(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ce(t,e){return!e||"object"!==Te(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function ze(t){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Re(t,e){return(Re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var De=function(t){var e,n,o;function p(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.aoTop,n=void 0!==e&&e,o=t.aoBottom,r=void 0!==o&&o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);var i=p.getGeometry({aoTop:n,aoBottom:r,orientation:"vertical",material:0});return i.translate(0,.5,-.5),i.scale(p.scale.x,p.scale.y,p.scale.z),Ce(this,ze(p).call(this,(new O.h).fromGeometry(i),new O.C({side:O.q,vertexColors:O.db})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Re(t,e)}(p,O["z"]),e=p,o=[{key:"getGeometry",value:function(t){var e=t.aoTop,r=void 0===e||e,n=t.aoBottom,i=void 0===n||n,o=t.width,a=void 0===o?1:o,c=t.height,s=void 0===c?1:c,u=t.material,l=t.orientation,f=new O.I(a,s,Math.ceil(a*p.scale.x),Math.ceil(s*("horizontal"===l?p.scale.x:p.scale.y))),h=new O.m;return f.faces.forEach(function(t,e){e%2==0&&h.setHSL(Math.random(),.05,.25+.125*Math.random()),t.materialIndex=u;var o=[f.vertices[t.a],f.vertices[t.b],f.vertices[t.c]];t.vertexColors=Ie(Array(3)).map(function(t,e){var n=h.clone();return(r&&Math.abs(o[e].y-.5*s)<1e-4||i&&Math.abs(o[e].y- -.5*s)<1e-4)&&n.offsetHSL(0,0,-.1),n})}),"horizontal"===l&&f.rotateX(-.5*Math.PI),f}}],(n=null)&&Fe(e.prototype,n),o&&Fe(e,o),p}();De.scale=new O.ab(4,3,4);var Le=De;function Ge(t){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Be(t,e){return!e||"object"!==Ge(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Ne(t){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function He(t,e){return(He=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ue=function(t){function f(t){var e=t.hasCeiling,n=t.hasElevator,o=t.isEdge,r=t.isLobby;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f);var i=new O.t,a=Le.getGeometry({aoBottom:!r,material:0,orientation:"horizontal"});if(i.merge(a),n){var c=Le.getGeometry({aoTop:e,width:.25,material:1});c.translate(-.375,.5,-.5),i.merge(c),c.translate(.75,0,0),i.merge(c)}else{var s=Le.getGeometry({aoTop:e,material:1});s.translate(0,.5,-.5),i.merge(s)}if(!r){var u=Le.getGeometry({aoTop:!1,height:1/3,material:1});if(u.rotateY(Math.PI),u.translate(0,1/3/2,.5),i.merge(u),o){var l=Le.getGeometry({aoTop:!1,height:1/3,material:1});l.rotateY(.5*Math.PI*("left"===o?1:-1)),l.translate("left"===o?-.5:.5,1/3/2,0),i.merge(l)}}return i.scale(Le.scale.x,Le.scale.y,Le.scale.z),Be(this,Ne(f).call(this,(new O.h).fromGeometry(i),[new J.a({side:O.q,vertexColors:O.db}),new O.C({side:O.q,vertexColors:O.db})]))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&He(t,e)}(f,O["z"]),f}();function We(t){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ve(t,e){return!e||"object"!==We(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function qe(t){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ke(t,e){return(Ke=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xe=function(t){function r(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r);var t=new O.t,e=new O.I(512,4);e.rotateX(-.5*Math.PI),e.faces.forEach(function(t){t.color.set(2236979),t.materialIndex=0});var n=new O.I(1,.2);n.rotateX(-.5*Math.PI),n.faces.forEach(function(t){t.color.set(12500670),t.materialIndex=0});for(var o=-128;o<128;o+=5)t.merge(n.clone().translate(o,.001,0));return t.merge(e),t.translate(0,0,4),Ve(this,qe(r).call(this,(new O.h).fromGeometry(t),new O.B({vertexColors:O.db})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ke(t,e)}(r,O["z"]),r}();function Ye(t){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Je(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Qe(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Ze(t,e){return!e||"object"!==Ye(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function $e(t){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tn(t,e){return(tn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var en=function(t){function i(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i);var n=new O.t,o=new O.I(1024,1024,2,2);o.rotateX(-.5*Math.PI),o.translate(0,0,512);var r=new O.I(1024,1024,2,2);return r.translate(0,512,0),n.merge(o),n.merge(r),(e=Ze(this,$e(i).call(this,(new O.h).fromGeometry(n),new O.A({transparent:!0,visible:!1})))).finder=new U.AStarFinder({allowDiagonal:!0,dontCrossCorners:!0}),e.grid=new U.Grid(t),e}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tn(t,e)}(i,O["z"]),e=i,(n=[{key:"getPath",value:function(t,e){var r=this,n=this.grid,o=this.finder;return t=this.worldToGrid(t),e=this.worldToGrid(e),o.findPath(t.x,t.z,e.x,e.z,n.clone()).map(function(t){var e=Je(t,2),n=e[0],o=e[1];return r.localToWorld(new O.ab(n+.5,0,o+.5))})}},{key:"worldToGrid",value:function(t){var e=this.grid,n=this.position;return t.y=n.y,this.worldToLocal(t),t.x=Math.floor(Math.min(Math.max(t.x,0),e.width-1)),t.z=Math.floor(Math.min(Math.max(t.z,0),e.height-1)),t}}])&&Qe(e.prototype,n),o&&Qe(e,o),i}();function nn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function on(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var rn=function(){function l(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),this.building=t,this.actors=[]}var t,e,n;return t=l,(e=[{key:"addActor",value:function(t){var e=t.actor,n=t.floor,o=t.position;this.actors.push({actor:e,floor:n,position:o,lastThought:0,state:l.states.IDLE})}},{key:"onAnimationTick",value:function(t){var s=t.time,e=this.actors,u=this.building;e.forEach(function(i){var a=i.floor,c=i.position,t=i.lastThought;if(i.state===l.states.IDLE)switch(3<s-t&&(i.lastThought=s,.75<Math.random()&&(i.state=l.states.WALKING)),i.state){case l.states.WALKING:if("break"===function(){var t,e,r=u.floors[a].walkable,n=r.finder,o=r.grid;for(o.setWalkableAt(c.x,c.z,!0);t={x:Math.floor(Math.random()*o.width),z:Math.floor(Math.random()*o.height)},(e=n.findPath(c.x,c.z,t.x,t.z,o.clone()).map(function(t){var e=nn(t,2),n=e[0],o=e[1];return r.localToWorld(new O.ab(n+.5,0,o+.5))})).length<2;);return o.setWalkableAt(t.x,t.z,!1),i.actor.walk(e.slice(1),function(){c.x=t.x,c.z=t.z,i.lastThought=s,i.state=l.states.IDLE}),"break"}())break}})}}])&&on(t.prototype,e),n&&on(t,n),l}();rn.states={IDLE:0,WALKING:1};var an=rn;function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function un(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function ln(t){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function fn(t,e){return(fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var pn=function(t){function i(t){var v,e,n,o=t.elevators,w=t.floors;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),e=this,n=ln(i).call(this),(v=!n||"object"!==cn(n)&&"function"!=typeof n?hn(e):n).ai=new an(hn(hn(v))),v.elevators=o.map(function(t){var e=t.floors,n=t.origin,o=new Ae({floors:e,origin:n});return o.position.x=4*n.x,o.position.y=3*n.y,v.add(o),o});var r=w.reduce(function(t,e){return Math.max(t,4*e.split("").length)},0);return v.heightmap=sn(Array(6)).map(function(){return sn(Array(r)).map(function(){return 0})}),v.floors=w.map(function(t,h){var p=[],y=[],d=[],b=t.split(""),m=sn(Array(4)).map(function(){return sn(Array(4*b.length)).map(function(){return 1})});b.forEach(function(t,o){var e;switch(t){case" ":return;case"_":e=new Le;break;case".":default:var n=!1;0===o||~[" ","_"].indexOf(b[o-1])?n="left":(o===b.length-1||~[" ","_"].indexOf(b[o+1]))&&(n="right");var r=h<w.length-1&&-1===[" ","_"].indexOf(w[h+1].split("")[o]),i=v.elevators.findIndex(function(t){var e=t.floors,n=t.origin;return n.x===o&&n.y<=h&&n.y+e>h}),a=~i;if(a){var c=v.elevators[i],s=c.doors[h-c.origin.y];p.push(s.callButton),y.push(s.collisionMesh),d.push(s.collisionMesh)}e=new Ue({hasCeiling:r,hasElevator:a,isEdge:n,isLobby:0===h});for(var u=0;u<4;u+=1){for(var l=0;l<6;l+=1)1<l?v.heightmap[l][4*o+u]=3*h:a&&0<u&&u<3&&(v.heightmap[l][4*o+u]=3*(h+1));for(var f=0;f<4;f+=1)m[f][4*o+u]=0}}e.position.set(4*o,3*h,0),v.add(e),d.push(e)});var e=new en(m);return e.position.set(-2,3*h,-2),v.add(e),{buttons:p,elevators:y,meshes:d,walkable:e}}),v.road=new Xe,v.add(v.road),v}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fn(t,e)}(i,O["E"]),e=i,(n=[{key:"addActor",value:function(t){var e=t.actor,n=t.floor,o=t.position;this.addToGrid({floor:n,mesh:e,position:o}),this.ai.addActor({actor:e,floor:n,position:o})}},{key:"addToGrid",value:function(t){var e=t.floor,n=t.mesh,o=t.position,r=this.floors[e].walkable;r.grid.setWalkableAt(o.x,o.z,!1),n.position.set(o.x+.5,0,o.z+.5).add(r.position),this.add(n)}},{key:"getHeight",value:function(t,e){var n=this.heightmap;return t=Math.floor(t+2),e=Math.floor(e+4),t<0||t>n[0].length-1||e<0||e>n.length-1?0:n[e][t]}},{key:"onAnimationTick",value:function(e){var t=this.ai,n=this.children;t.onAnimationTick(e),n.forEach(function(t){t.onAnimationTick&&t.onAnimationTick(e)})}}])&&un(e.prototype,n),o&&un(e,o),i}();function yn(t){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dn(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function bn(t,e){return!e||"object"!==yn(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function mn(t){return(mn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function vn(t,e){return(vn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),bn(this,mn(e).call(this,"dialog"))}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&vn(t,e)}(e,gt),n=e,(o=[{key:"show",value:function(t,e){var n=this,o=t.floor,r=t.floors,i=t.origin,a=e.onFloor,c=e.onExit;this.empty();for(var s=r-1;0<=s;s-=1){var u=this.add("button",o===s?"active":"");o!==s&&u.addEventListener("click",function(t){return function(){n.unmount(),a(t)}}(s),!1),u.innerText=i.y+s}var l=this.add("button","exit");l.addEventListener("click",function(){n.unmount(),c()},!1),l.innerText="Exit elevator",this.mount()}}])&&dn(n.prototype,o),r&&dn(n,r),e}();function gn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var On=function(t){var C=t.input,z=t.scene,e=new Ht;z.root.add(e);var n=new Zt;z.root.add(n);var F=new x({arms:2236962,eyes:10027008,head:3355443,legs:2236962,torso:10027008});F.position.set(6,0,0),F.destinationMarker=new B,z.root.add(F),z.root.add(F.destinationMarker),z.camera.target=F.position;var R=new pn({elevators:[{floors:4,origin:{x:2,y:0}},{floors:4,origin:{x:4,y:1}}],floors:["  ..."," .._..","..._..","......"," ...."].reverse()});z.root.add(R),z.camera.minHeight=.1,z.camera.maxHeight=2.9,z.camera.testMeshes=R.floors.reduce(function(t,e){var n=e.meshes;return gn(t).concat(gn(n))},[]),e.position.x=.5*R.heightmap[0].length,e.setHeightTest(R.getHeight.bind(R));var r=[x,Y,Y],D=gn(Array(R.floors.length*r.length)).map(function(){for(var t,e=new(r[Math.floor(Math.random()*r.length)])({arms:2236962,eyes:10066329*Math.random(),hat:.5<Math.random()&&10066329*Math.random(),head:10066329*Math.random(),legs:2236962,torso:10066329*Math.random()}),n=Math.floor(Math.random()*R.floors.length),o=R.floors[n].walkable.grid;t={x:Math.floor(Math.random()*o.width),z:Math.floor(Math.random()*(o.height-1))},!o.isWalkableAt(t.x,t.z););return R.addActor({floor:n,actor:e,position:t}),e.position.y+=.001,e.collisionMesh.floor=n,e.collisionMesh}).reduce(function(t,e){return t[e.floor]||(t[e.floor]=[]),t[e.floor].push(e),t},{}),L=new wn,G=0;z.onAnimationTick=function(){var t=z.camera,e=R.floors[G],n=e.buttons,o=e.elevators,r=e.walkable,i=C.getPointerFrame();if(t.processPointer(i),i.primaryUp){var a=t.getRaycaster(i.normalized),c=a.intersectObjects(D[G]||[])[0];if(c){var s=c.object.parent,u=["Fuck You","Go away","Leave me alone"],l=function(){F.faceTo(s.position),setTimeout(function(){return s.say([u[Math.floor(Math.random()*u.length)]])},500)},f=F.position.clone(),h=s.position.clone();h.z+=1;var p=r.getPath(f,h);1<p.length?(r.grid.setWalkableAt(f.x,f.z,!0),F.walk(p.slice(1),function(){r.grid.setWalkableAt(h.x,h.z,!1),l()})):p.length&&l()}else{var y=a.intersectObjects(o)[0];if(y){var d=y.point,b=y.object.elevator,m=G-b.origin.y;if(b.floor===m&&0===b.doors[m].state){var v=function(){C.isEnabled=!1;var e=b.cabin.position.clone().add(b.position);F.walk([e],function(){b.doors[m].close(),L.show(b,{onFloor:function(t){b.addPassenger(F),b.onCall(t,function(){e.copy(b.cabin.position).add(b.position),e.z+=1,b.removePassenger(F),F.walk([e],function(){G=b.origin.y+t,C.isEnabled=!0})})},onExit:function(){b.doors[m].open(),e.z+=1,F.walk([e],function(){C.isEnabled=!0})}})})},w=F.position.clone(),g=d.clone(),O=r.getPath(w,g);return void(O.length&&(r.grid.setWalkableAt(w.x,w.z,!0),1<O.length?F.walk(O.slice(1),v):v()))}}var P=a.intersectObjects(n)[0];if(P){var k=P.point,S=P.object,j=function(){F.faceTo(k),S.tap()},_=F.position.clone(),x=k.clone(),M=r.getPath(_,x);1<M.length?(r.grid.setWalkableAt(_.x,_.z,!0),F.walk(M.slice(1),function(){r.grid.setWalkableAt(x.x,x.z,!1),j()})):M.length&&j()}else{var E=a.intersectObject(r)[0];if(E){var A=F.position.clone(),T=E.point.clone(),I=r.getPath(A,T);1<I.length&&(r.grid.setWalkableAt(A.x,A.z,!0),F.walk(I.slice(1),function(){r.grid.setWalkableAt(T.x,T.z,!1)}))}}}}}};n.d(e,"debug",function(){return F}),n.d(e,"editor",function(){return $t}),n.d(e,"game",function(){return On})},iCY1:function(t,e,n){"use strict";n("MZFn");var l=n("Womt");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var f=function(t){function o(){var t,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),e=this,(t=!(n=c(o).call(this,90,1,.1,2048))||"object"!==i(n)&&"function"!=typeof n?u(e):n).distance=5,t.maxDistance=16,t.minHeight=-1/0,t.maxHeight=1/0,t.offset=new l.ab(0,1.2,0),t.tilt=-.45*Math.PI,t.pitch=.1*Math.PI,t.speed=1.25,t.step=new l.ab,t.raycaster=new l.N,t.root=new l.E,t.root.add(u(u(t))),t.forward=new l.ab,t.right=new l.ab,t.worldUp=new l.ab(0,1,0),t.updateOrbit(),t}var e,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(o,l["G"]),e=o,(n=[{key:"getRaycaster",value:function(t){var e=this.raycaster;return e.setFromCamera(t,this),e.far=1/0,e}},{key:"onAnimationTick",value:function(t){var e=t.delta,n=this.root.position,o=this.speed,r=this.step,i=this.target;!i||n.distanceTo(i)<=.1||(r.copy(i).sub(n).normalize().multiplyScalar(e*o),n.add(r))}},{key:"processPointer",value:function(t){var e=t.movement,n=t.secondary,o=t.wheel,r=!1;if(n){this.tilt-=.003*e.x,this.pitch+=.003*e.y,this.pitch=Math.min(Math.max(this.pitch,-.45*Math.PI),.45*Math.PI),r=!0}if(o){var i=this.maxDistance;this.distance=Math.min(Math.max(this.distance+.006*o,1),i),r=!0}return r&&this.updateOrbit(),r}},{key:"processKeyboard",value:function(t){var e=t.backwards,n=t.delta,o=t.forwards,r=t.leftwards,i=t.rightwards,a=this.forward,c=this.right,s=this.tilt,u=this.pitch,l=this.root.position,f=this.worldUp,h=4*n;a.set(Math.cos(s)*Math.cos(u),0,Math.sin(-s)*Math.cos(u)).normalize().negate(),c.crossVectors(a,f),o&&l.addScaledVector(a,h),e&&l.addScaledVector(a,-h),r&&l.addScaledVector(c,-h),i&&l.addScaledVector(c,h)}},{key:"updateOrbit",value:function(){var t=this.minHeight,e=this.maxHeight,n=this.offset,o=this.pitch,r=this.position,i=this.raycaster,a=this.root,c=this.testMeshes,s=this.tilt,u=this.distance;if(r.set(Math.cos(s)*Math.cos(o),Math.sin(o),Math.sin(-s)*Math.cos(o)).normalize(),i.ray.origin.copy(a.position).add(n),c){i.ray.direction.copy(r),i.far=u;var l=i.intersectObjects(c)[0];l&&(u=l.distance-.25)}r.multiplyScalar(u).add(n),r.y=Math.min(Math.max(r.y,t),e),this.lookAt(i.ray.origin)}}])&&a(e.prototype,n),r&&a(e,r),o}(),h=n("seR1");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=function(t){function u(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.background,o=void 0===n?new l.m(16777215):n,r=e.size,i=void 0===r?1:r,a=e.subdivisions,c=void 0===a?10:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);var s=new l.j(128,8);return s.translate(0,0,-.001),s.rotateX(-.5*Math.PI),(t=p(this,y(u).call(this,s,new h.a({size:i,subdivisions:c})))).material.color.set(o),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(u,l["z"]),u}(),b=n("xeez");function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function w(t,e){return!e||"object"!==m(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=w(this,g(e).call(this))).camera=new l.F(-.5,.5,.5,-.5,0,1),t.sprite=new b.a({width:0,height:0}),t.sprite.map.wrapS=l.k,t.sprite.map.wrapT=l.k,t.sprite.map.magFilter=l.D,t.sprite.map.minFilter=l.x,t.add(new l.W(t.sprite)),t}var n,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(e,l["O"]),n=e,(o=[{key:"onResize",value:function(t){var e=t.width,n=t.height,o=this.sprite,r=o.renderer,i=o.ctx,a=Math.max(e,n);r.width=a,r.height=a;var c=i.createRadialGradient(.5*a,.5*a,.6*a,.5*a,.5*a,a);c.addColorStop(0,"rgba(0, 0, 0, 0)"),c.addColorStop(1,"rgba(0, 0, 0, 1)"),i.fillStyle=c,i.beginPath(),i.rect(0,0,a,a),i.fill(),o.map.needsUpdate=!0}},{key:"render",value:function(t){t.clearDepth(),t.render(this,this.camera)}}])&&v(n.prototype,o),r&&v(n,r),e}();function k(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var S=function(){function i(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).mount,e=void 0===t?document.body:t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.camera=new f,this.clock=new l.l,this.mount=e,this.renderer=new l.eb({alpha:!1,antialias:!0}),this.renderer.autoClear=!1,this.renderer.setAnimationLoop(this.onAnimate.bind(this)),this.renderer.setPixelRatio(window.devicePixelRatio||1);var n=new l.m(3359829);this.renderer.setClearColor(n),e.appendChild(this.renderer.domElement),this.root=new l.O,this.root.fog=new l.s(n,.03),this.root.add(new l.a(6710886));var o=new l.p(16777215,.3);o.position.set(1,.5,1),this.root.add(o);var r=new l.p(16777215,.2);r.position.set(-1,-.5,1),this.root.add(r),this.root.add(this.camera.root),this.grid=new d({background:new l.m(3355460)}),this.root.add(this.grid),this.vignette=new P,window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize()}var t,e,n;return t=i,n=[{key:"fixThreeJSFog",value:function(){l.P.fog_pars_vertex=l.P.fog_pars_vertex.replace("varying float fogDepth;","varying vec4 fogDepth;"),l.P.fog_vertex=l.P.fog_vertex.replace("fogDepth = -mvPosition.z;","fogDepth = mvPosition;"),l.P.fog_pars_fragment=l.P.fog_pars_fragment.replace("varying float fogDepth;","varying vec4 fogDepth;"),l.P.fog_fragment=l.P.fog_fragment.replace("float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );",["float fogDist = length(fogDepth);","float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDist * fogDist * LOG2 ) );"].join("\n")).replace("float fogFactor = smoothstep( fogNear, fogFar, fogDepth );","float fogFactor = smoothstep( fogNear, fogFar, length(fogDepth) );")}}],(e=[{key:"onAnimate",value:function(){var t=this.clock,e=this.camera,n=this.grid,o=this.renderer,r=this.root,i=this.stats,a=this.vignette;i&&i.begin();var c={delta:Math.min(t.getDelta(),1),time:t.oldTime/1e3};this.onAnimationTick&&this.onAnimationTick(c),r.children.forEach(function(t){t.onAnimationTick&&t.onAnimationTick(c)}),e.onAnimationTick&&e.onAnimationTick(c),n.position.set(e.root.position.x,0,e.root.position.z),o.clear(),o.render(r,e),a.render(o),i&&i.end()}},{key:"onResize",value:function(){var t=this.camera,e=this.mount,n=this.renderer,o=this.vignette,r=e.getBoundingClientRect(),i=r.width,a=r.height;n.setSize(i,a),t.aspect=i/a,t.updateProjectionMatrix(),o.onResize({width:i,height:a})}}])&&k(t.prototype,e),n&&k(t,n),i}();S.fixThreeJSFog(),l.M.DefaultInterpolation=l.w,l.cb.DefaultInterpolation=l.w;e.a=S},seR1:function(t,e,n){"use strict";var y=n("Womt");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function b(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var i=function(t){function p(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.color,o=void 0===n?16777215:n,r=e.size,i=void 0===r?1:r,a=e.subdivisions,c=void 0===a?10:a,s=d(e,["color","size","subdivisions"]);!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);var u=y.Q.lambert.vertexShader.replace("#include <clipping_planes_pars_vertex>",["#include <clipping_planes_pars_vertex>","varying vec3 vPosition;","varying float vOrientation;"].join("\n")).replace("#include <fog_vertex>",["#include <fog_vertex>","vPosition = (modelMatrix * vec4( transformed, 1.0 )).xyz;","vOrientation = normal.y != 0.0 ? 1.0 : (normal.x != 0.0 ? 2.0 : 0.0);"].join("\n")),l=1/i,f=l*c,h=y.Q.lambert.fragmentShader.replace("#include <clipping_planes_pars_fragment>",["#include <clipping_planes_pars_fragment>","varying vec3 vPosition;","varying float vOrientation;","float getGrid(float scale) {"," vec2 coord = (vOrientation > 1.5 ? vPosition.zy : (vOrientation > 0.5 ? vPosition.xz : vPosition.xy)) * scale;"," vec2 grid = abs(fract(coord - 0.5) - 0.5) / fwidth(coord);"," return 1.0 - min(min(grid.x, grid.y), 1.0);","}"].join("\n")).replace("vec4 diffuseColor = vec4( diffuse, opacity );",["float primaryGrid = getGrid(".concat(l).concat(l%1==0?".0":"",");"),"float secondaryGrid = getGrid(".concat(f).concat(f%1==0?".0":"",");"),"vec3 grid = mix(mix(diffuse, diffuse * 0.95, secondaryGrid), diffuse * 1.15, primaryGrid);","vec4 diffuseColor = vec4(grid, opacity);"].join("\n"));return(t=b(this,m(p).call(this,function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},e=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.forEach(function(t){var e,n,o;e=r,o=i[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return r}({name:"grid-material-".concat(i,"-").concat(c),uniforms:y.Y.clone(y.Q.lambert.uniforms),fragmentShader:h,vertexShader:u,extensions:{derivatives:!0},fog:!0,lights:!0},s)))).color=t.uniforms.diffuse.value,t.color.set(o),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(p,y["R"]),p}();e.a=i},tjUo:function(t,e,p){"use strict";p.r(e),function(t){var i,a,e=p("T5+8"),n=p("Qw7Z"),o=p("iCY1"),c=p("gaOq"),r=document.getElementById("mount"),s=document.getElementById("splash"),u=new e.a({mount:r}),l=new n.a({toggle:document.getElementById("sound")}),f=new o.a({mount:r}),h=window.location.hash.split("/").slice(1)[0];c[h]||(window.location.hash="/game",h="game"),t(function(){return window.addEventListener("hashchange",function(){return window.location.reload()},!1)}),a=0,(i=[{font:"'Print Char 21'",test:"QW@HhsXJ"}]).forEach(function(t){var e=t.font,n=t.test,o=document.createElement("div");o.innerText=n,o.style.position="absolute",o.style.fontFamily="sans-serif",o.style.top="-999999px",document.body.appendChild(o);var r=o.getBoundingClientRect().width;o.style.fontFamily=e,function t(){var e=o.getBoundingClientRect().width;r<e?(document.body.removeChild(o),(a+=1)===i.length&&(document.body.className="loaded",c[h]({input:u,scene:f}),u.touches.once("end",function(){s.style.display="none",u.isEnabled=!0,l.play()}))):setTimeout(t,10)}()}),window.process&&window.process.type&&window.addEventListener("keydown",function(t){var e=t.keyCode,n=t.repeat;27!==e||n||("none"!==s.style.display?window.close():(s.style.display="",u.isEnabled=!1,u.touches.once("end",function(){s.style.display="none",u.isEnabled=!0})))},!1)}.call(this,p("URgk").setImmediate)},xeez:function(t,e,n){"use strict";var s=n("Womt");function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function l(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var i=function(t){function c(t){var e,n=t.width,o=t.height,r=u(t,["width","height"]);!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c);var i=document.createElement("canvas");i.width=n,i.height=o;var a=new s.i(i);return(e=l(this,f(c).call(this,function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},e=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.forEach(function(t){var e,n,o;e=r,o=i[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return r}({map:a},r)))).renderer=i,e.ctx=i.getContext("2d"),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(c,s["X"]),c}();e.a=i}},[[0,1,2]]]);
//# sourceMappingURL=main.66e752d0f7288c75e94df1c7abb35e2c.js.map