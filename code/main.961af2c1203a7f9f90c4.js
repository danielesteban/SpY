(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{0:function(t,e,n){n("FlHw"),t.exports=n("tjUo")},FlHw:function(t,e,n){},tjUo:function(t,e,n){"use strict";n.r(e);var o={};n.r(o),n.d(o,"debug",function(){return pt}),n.d(o,"game",function(){return Dt});var y=n("Womt"),r=n("1339"),i=n.n(r),a=n("fWck");function f(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var s=function(){function o(t){var e=t.mount,n=void 0===e?document.body:e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this.mount=n,this.pointer={current:new y.L(0,0),movement:{x:0,y:0},normalized:new y.L(0,0),last:new y.L(0,0),raycaster:new y.B,wheel:0},this.touches=i()(window,{filtered:!0,preventSimulated:!1,target:n}).on("start",this.onPointerDown.bind(this)).on("move",this.onPointerMove.bind(this)).on("end",this.onPointerUp.bind(this)),Object(a.addWheelListener)(window,this.onPointerWheel.bind(this)),window.addEventListener("contextmenu",function(t){return t.preventDefault()},!1),window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize()}var t,e,n;return t=o,(e=[{key:"getPointerFrame",value:function(){var t=this.pointer,e=function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},e=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.forEach(function(t){var e,n,o;e=r,o=i[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return r}({},t);return t.primaryDown=!1,t.primaryUp=!1,t.secondaryDown=!1,t.secondaryUp=!1,t.movement={x:0,y:0},t.wheel=0,e}},{key:"onPointerDown",value:function(t){var e=t.button,n=this.isEnabled,o=this.pointer;if(n)switch(e){case 0:o.primary=!0,o.primaryDown=!0;break;case 2:o.secondary=!0,o.secondaryDown=!0}}},{key:"onPointerMove",value:function(t,e){var n=f(e,2),o=n[0],r=n[1],i=this.isEnabled,a=this.pointer,c=this.size,s=c.width,u=c.height;i&&(a.current.x=o,a.current.y=r,a.normalized.x=o/s*2-1,a.normalized.y=1-r/u*2,a.movement={x:a.current.x-a.last.x,y:a.current.y-a.last.y},a.last.copy(a.current))}},{key:"onPointerUp",value:function(t){var e=t.button,n=this.isEnabled,o=this.pointer;if(n)switch(e){case 0:o.primary=!1,o.primaryUp=!0;break;case 2:o.secondary=!1,o.secondaryUp=!0}}},{key:"onPointerWheel",value:function(t){var e=t.deltaY,n=this.isEnabled,o=this.pointer;n&&(o.wheel=e)}},{key:"onResize",value:function(){var t=this.mount;this.size=t.getBoundingClientRect()}}])&&c(t.prototype,e),n&&c(t,n),o}();n("MZFn");function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var b=function(t){function o(){var t,e,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),e=this,(t=!(n=p(o).call(this,60,1,.01,2048))||"object"!==u(n)&&"function"!=typeof n?m(e):n).distance=4,t.offset=new y.M(0,1.2,0),t.tilt=-.65*Math.PI,t.pitch=.1*Math.PI,t.speed=1.25,t.step=new y.M,t.root=new y.t,t.root.add(m(m(t))),t.updateOrbit(),t}var e,n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(o,y["u"]),e=o,(n=[{key:"onAnimationTick",value:function(t){var e=t.delta,n=this.root.position,o=this.speed,r=this.step,i=this.target;!i||n.distanceTo(i)<=.1||(r.copy(i).sub(n).normalize().multiplyScalar(e*o),n.add(r))}},{key:"processInput",value:function(t){var e=t.movement,n=t.secondary,o=t.wheel,r=!1;if(n){this.tilt-=.003*e.x,this.pitch+=.003*e.y,this.pitch=Math.min(Math.max(this.pitch,0),.5*Math.PI),r=!0}if(o){this.distance=Math.min(Math.max(this.distance+.006*o,1),8),r=!0}return r&&this.updateOrbit(),r}},{key:"updateOrbit",value:function(){var t=this.distance,e=this.offset,n=this.pitch,o=this.position,r=this.root,i=this.tilt;o.set(Math.cos(i)*Math.cos(n),Math.sin(n),Math.sin(-i)*Math.cos(n)).normalize().multiplyScalar(t),this.lookAt(r.position),o.add(e)}}])&&l(e.prototype,n),r&&l(e,r),o}();function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){if(null==t)return{};var n,o,r=function(t,e){if(null==t)return{};var n,o,r={},i=Object.keys(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(o=0;o<i.length;o++)n=i[o],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function w(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var P=function(t){function h(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.color,o=void 0===n?16777215:n,r=e.size,i=void 0===r?1:r,a=e.subdivisions,c=void 0===a?10:a,s=v(e,["color","size","subdivisions"]);!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h);var u=y.E.phong.vertexShader.replace("#include <clipping_planes_pars_vertex>",["#include <clipping_planes_pars_vertex>","varying vec3 vPosition;"].join("\n")).replace("#include <fog_vertex>",["#include <fog_vertex>","vPosition = (modelMatrix * vec4( transformed, 1.0 )).xyz;"].join("\n")),f=1/i,l=f*c,p=y.E.phong.fragmentShader.replace("#include <clipping_planes_pars_fragment>",["#include <clipping_planes_pars_fragment>","varying vec3 vPosition;","float getGrid(float scale) {"," vec2 coord = vPosition.xz * scale;"," vec2 grid = abs(fract(coord - 0.5) - 0.5) / fwidth(coord);"," return 1.0 - min(min(grid.x, grid.y), 1.0);","}"].join("\n")).replace("vec4 diffuseColor = vec4( diffuse, opacity );",["float primaryGrid = getGrid(".concat(f).concat(f%1==0?".0":"",");"),"float secondaryGrid = getGrid(".concat(l).concat(l%1==0?".0":"",");"),"vec3 grid = mix(mix(diffuse, diffuse * 0.95, secondaryGrid), diffuse * 1.15, primaryGrid);","vec4 diffuseColor = vec4(grid, opacity);"].join("\n"));return(t=w(this,g(h).call(this,function(r){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},e=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),e.forEach(function(t){var e,n,o;e=r,o=i[n=t],n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o})}return r}({name:"grid-material-".concat(i,"-").concat(c),uniforms:y.K.clone(y.E.phong.uniforms),fragmentShader:p,vertexShader:u,extensions:{derivatives:!0},fog:!0,lights:!0},s)))).color=t.uniforms.diffuse.value,t.color.set(o),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(h,y["F"]),h}();function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){return!e||"object"!==M(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function _(t){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var A=function(t){function u(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.background,o=void 0===n?new y.i(16777215):n,r=e.size,i=void 0===r?1:r,a=e.subdivisions,c=void 0===a?10:a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);var s=new y.v(2048,2048,2,2);return s.translate(0,0,-.01),s.rotateX(-.5*Math.PI),(t=j(this,_(u).call(this,s,new P({size:i,subdivisions:c})))).material.color.set(o),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(u,y["q"]),u}();function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){return!e||"object"!==I(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var T=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),x(this,k(e).call(this,new y.I(100,32,32),new y.r({color:10066329,fog:!1})))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(e,y["q"]),e}();function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){return!e||"object"!==D(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return(R=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var C=function(t){function s(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s);for(var e=1024,n=new y.f,o=new Float32Array(3e4),r=new Float32Array(1e4),i=new y.M,a=0;a<1e4;a+=1){i.set(Math.floor(2049*Math.random())-e,Math.floor(1025*Math.random()),Math.floor(2049*Math.random())-e).normalize().multiplyScalar(e);var c=3*a;o[c]=i.x,o[c+1]=i.y,o[c+2]=i.z,r[a]=10+Math.floor(100*Math.random())}return n.addAttribute("position",new y.e(o,3)),n.addAttribute("size",new y.e(r,1)),(t=z(this,F(s).call(this,n,new y.y({color:10066329,fog:!1,sizeAttenuation:!1})))).moon=new T,t.moon.position.set(e,512,e),t.add(t.moon),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&R(t,e)}(s,y["x"]),s}();function L(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var B=function(){function i(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).mount,e=void 0===t?document.body:t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),this.camera=new b,this.clock=new y.h,this.mount=e,this.renderer=new y.Q({alpha:!1,antialias:!0}),this.renderer.setAnimationLoop(this.onAnimate.bind(this)),this.renderer.setPixelRatio(window.devicePixelRatio||1);var n=new y.i(3359829);this.renderer.setClearColor(n),e.appendChild(this.renderer.domElement),this.root=new y.C,this.root.fog=new y.n(n,.025),this.root.add(new y.a(3355443));var o=new y.k(16777215,.8);o.position.set(1,.5,1),this.root.add(o);var r=new y.k(16777215,.2);r.position.set(-1,-.5,1),this.root.add(r),this.root.add(this.camera.root),this.grid=new A({background:new y.i(3355460)}),this.root.add(this.grid),this.starfield=new C,this.root.add(this.starfield),window.addEventListener("resize",this.onResize.bind(this),!1),this.onResize()}var t,e,n;return t=i,n=[{key:"fixThreeJSFog",value:function(){y.D.fog_pars_vertex=y.D.fog_pars_vertex.replace("varying float fogDepth;","varying vec4 fogDepth;"),y.D.fog_vertex=y.D.fog_vertex.replace("fogDepth = -mvPosition.z;","fogDepth = mvPosition;"),y.D.fog_pars_fragment=y.D.fog_pars_fragment.replace("varying float fogDepth;","varying vec4 fogDepth;"),y.D.fog_fragment=y.D.fog_fragment.replace("float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );",["float fogDist = length(fogDepth);","float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDist * fogDist * LOG2 ) );"].join("\n")).replace("float fogFactor = smoothstep( fogNear, fogFar, fogDepth );","float fogFactor = smoothstep( fogNear, fogFar, length(fogDepth) );")}}],(e=[{key:"onAnimate",value:function(){var t=this.clock,e=this.camera,n=this.grid,o=this.renderer,r=this.root,i=this.starfield,a=this.stats;a&&a.begin();var c={delta:Math.min(t.getDelta(),1),time:t.oldTime/1e3};this.onAnimationTick&&this.onAnimationTick(c),r.children.forEach(function(t){t.onAnimationTick&&t.onAnimationTick(c)}),e.onAnimationTick&&e.onAnimationTick(c),n.position.set(e.root.position.x,0,e.root.position.z),i.position.copy(n.position),o.render(r,e),a&&a.end()}},{key:"onResize",value:function(){var t=this.camera,e=this.mount,n=this.renderer,o=e.getBoundingClientRect(),r=o.width,i=o.height;n.setSize(r,i),t.aspect=r/i,t.updateProjectionMatrix()}}])&&L(t.prototype,e),n&&L(t,n),i}();B.fixThreeJSFog(),y.A.DefaultInterpolation=y.p,y.O.DefaultInterpolation=y.p;var q=B;function G(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function J(t){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function N(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function H(t,e,n){return e&&N(t.prototype,e),n&&N(t,n),t}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var K=function(t){function h(t){var n,e,o,r=t.geometry,i=t.material;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),e=this,o=J(h).call(this,r,i),n=!o||"object"!==W(o)&&"function"!=typeof o?Y(e):o;var a=new y.d;n.add(a);var c=new y.d;a.add(c);var s=new y.d;c.add(s);var u=new y.d;c.add(u);var f=new y.d;c.add(f);var l=new y.d;a.add(l);var p=new y.d;return a.add(p),n.bind(new y.G([a,c,s,u,f,l,p])),n.mixer=new y.c(Y(Y(n))),n.actions=Object.keys(h.animations).reduce(function(t,e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(t){U(e,t,n[t])})}return e}({},t,U({},e,n.mixer.clipAction(h.animations[e])))},{}),n.animation="idle",n.actions.idle.timeScale=.5,n.actions.idle.play(),n.rotationAux=new y.L,n.movementAux=new y.M,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(h,y["H"]),H(h,null,[{key:"geometryFromLimbs",value:function(t){var n=new y.o;Object.keys(t).forEach(function(e){t[e].faces.forEach(function(t){t.materialIndex=h.Bones[e]}),n.merge(t[e])}),n.faces.forEach(function(t){n.vertices[t.a].bone=t.materialIndex,n.vertices[t.b].bone=t.materialIndex,n.vertices[t.c].bone=t.materialIndex,t.materialIndex=0}),n.vertices.forEach(function(t){n.skinIndices.push(new y.N(t.bone,0,0,0)),n.skinWeights.push(new y.N(1,0,0,0))});var e=(new y.f).fromGeometry(n);return e.computeVertexNormals(),e.computeBoundingSphere(),e}}]),H(h,[{key:"onAnimationTick",value:function(t){var e=t.delta,n=this.actions.walk.timeScale,o=this.destination,r=this.destinationMarker,i=this.mixer,a=this.movementAux,c=this.position,s=this.rotationSpeed,u=this.targetRotation;if(i.update(e),u){var f=e*s,l=u-this.rotation.y;this.rotation.y+=Math.min(Math.max(l,-f),f),Math.abs(l)<=f&&(this.targetRotation=!1)}if(o){var p=c.distanceTo(o),h=1.5*e*n;c.add(a.copy(o).sub(c).normalize().multiplyScalar(Math.min(p,h))),p<=h&&(this.setAnimation("idle"),this.destination=!1,r&&(r.visible=!1),this.onDestinationCallback&&this.onDestinationCallback())}}},{key:"setAnimation",value:function(t){var e=this.actions;this.animation!==t&&(e[this.animation].fadeOut(.2),this.animation=t,e[this.animation].reset().fadeIn(.2).play())}},{key:"walkTo",value:function(t){var e=this.destinationMarker;this.setAnimation("walk"),this.destination=t.clone(),e&&(e.position.copy(this.destination),e.visible=!0),this.faceTo(t)}},{key:"faceTo",value:function(t){for(var e=this.position,n=this.rotationAux.set(t.x-e.x,t.z-e.z).angle();this.rotation.y<-Math.PI;)this.rotation.y+=2*Math.PI;for(;this.rotation.y>Math.PI;)this.rotation.y-=2*Math.PI;for(this.targetRotation=.5*Math.PI-n;this.targetRotation<-Math.PI;)this.targetRotation+=2*Math.PI;for(;this.targetRotation>Math.PI;)this.targetRotation-=2*Math.PI;this.targetRotation-this.rotation.y>Math.PI?this.targetRotation-=2*Math.PI:this.targetRotation-this.rotation.y<-Math.PI&&(this.targetRotation+=2*Math.PI),this.rotationSpeed=1.5*Math.abs(this.targetRotation-this.rotation.y)}}]),h}();K.Bones={hip:0,torso:1,head:2,leftArm:3,rightArm:4,leftLeg:5,rightLeg:6};var Q=function(t,e,n){return(new y.z).setFromEuler(new y.m(t,e,n)).toArray()};K.animations={idle:new y.b("idle",1,[new y.A(".bones[".concat(K.Bones.torso,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(G(Q(0,-.05*Math.PI,0)).concat(G(Q(0,.05*Math.PI,0)),G(Q(0,-.05*Math.PI,0))))),new y.A(".bones[".concat(K.Bones.head,"].quaternion"),new Float32Array([0,.75,1]),new Float32Array(G(Q(-.075*Math.PI,0,-.025*Math.PI)).concat(G(Q(-.075*Math.PI,0,.025*Math.PI)),G(Q(-.075*Math.PI,0,-.025*Math.PI))))),new y.A(".bones[".concat(K.Bones.leftArm,"].quaternion"),new Float32Array([0,.75,1]),new Float32Array(G(Q(0,0,-.05*Math.PI)).concat(G(Q(0,0,-.1*Math.PI)),G(Q(0,0,-.05*Math.PI))))),new y.A(".bones[".concat(K.Bones.rightArm,"].quaternion"),new Float32Array([0,.25,1]),new Float32Array(G(Q(0,0,.05*Math.PI)).concat(G(Q(0,0,.1*Math.PI)),G(Q(0,0,.05*Math.PI)))))]),walk:new y.b("walk",1,[new y.A(".bones[".concat(K.Bones.torso,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(G(Q(-.02*Math.PI,0,.01*Math.PI)).concat(G(Q(.02*Math.PI,0,-.01*Math.PI)),G(Q(-.02*Math.PI,0,.01*Math.PI))))),new y.A(".bones[".concat(K.Bones.head,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(G(Q(0,0,-.025*Math.PI)).concat(G(Q(0,0,.025*Math.PI)),G(Q(0,0,-.025*Math.PI))))),new y.A(".bones[".concat(K.Bones.leftArm,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(G(Q(.1*Math.PI,0,0)).concat(G(Q(-.1*Math.PI,0,-.1*Math.PI)),G(Q(.1*Math.PI,0,0))))),new y.A(".bones[".concat(K.Bones.rightArm,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(G(Q(-.1*Math.PI,0,.1*Math.PI)).concat(G(Q(.1*Math.PI,0,0)),G(Q(-.1*Math.PI,0,.1*Math.PI))))),new y.A(".bones[".concat(K.Bones.leftLeg,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(G(Q(-.15*Math.PI,0,.01*Math.PI)).concat(G(Q(.15*Math.PI,0,-.01*Math.PI)),G(Q(-.15*Math.PI,0,.01*Math.PI))))),new y.A(".bones[".concat(K.Bones.rightLeg,"].quaternion"),new Float32Array([0,.5,1]),new Float32Array(G(Q(.15*Math.PI,0,-.01*Math.PI)).concat(G(Q(-.15*Math.PI,0,.01*Math.PI)),G(Q(.15*Math.PI,0,-.01*Math.PI)))))])};var V=K;function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function et(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var nt=function(t){function i(t){var e,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n=this;var r=et(et(e=!(o=$(i).call(this,{geometry:i.geometry(t),material:i.material}))||"object"!==Z(o)&&"function"!=typeof o?et(n):o)).skeleton.bones;return Object.keys(i.bones).forEach(function(t){r[V.Bones[t]].position.copy(i.bones[t])}),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(i,V),i}();nt.bones={hip:new y.M(0,.5,0),torso:new y.M(0,0,0),head:new y.M(0,.5,0),leftArm:new y.M(-.15,.475,0),rightArm:new y.M(.15,.475,0),leftLeg:new y.M(-.075,0,0),rightLeg:new y.M(.075,0,0)},nt.geometry=function(e){var t=new y.j(.175,.15,.5,6);t.translate(0,.25,0),t.faces.forEach(function(t){t.color.set(e.torso||10027008)});var n=new y.J(.2,8,4);n.translate(0,.2,0),n.faces.forEach(function(t){t.color.set(e.head)});var o=new y.J(.05);o.faces.forEach(function(t){t.color.set(e.eyes)});var r=o.clone();o.translate(-.1,.2,.15),r.translate(.1,.2,.15),n.merge(o),n.merge(r);var i=new y.j(.05,.03,.4,6);i.faces.forEach(function(t){t.color.set(e.arms)});var a=i.clone();i.translate(0,-.2,0),a.translate(0,-.2,0);var c=new y.j(.05,.05,.5,4);c.faces.forEach(function(t){t.color.set(e.legs)});var s=c.clone();c.translate(0,-.25,0),s.translate(0,-.25,0);var u=V.geometryFromLimbs({torso:t,head:n,leftArm:i,rightArm:a,leftLeg:c,rightLeg:s});return u.boundingSphere.center.set(0,.7,0),u.boundingSphere.radius=.7,u},nt.material=new y.s({skinning:!0,vertexColors:y.P});var ot=nt;function rt(t){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function at(t,e){return!e||"object"!==rt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ut=function(t){function n(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var e=new y.g(.25,16);return e.rotateX(-.5*Math.PI),e.translate(0,.001,0),(t=at(this,ct(n).call(this,e,new y.s({color:2236962,transparent:!0})))).visible=!1,t}var e,o,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(n,y["q"]),e=n,(o=[{key:"onAnimationTick",value:function(t){var e=t.time,n=this.material,o=this.scale;if(this.visible){var r=.125*(1+Math.sin(4*e)),i=.75+r;o.set(i,1,i),n.opacity=.25+r}}}])&&it(e.prototype,o),r&&it(e,r),n}();function ft(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){r=!0,i=t}finally{try{o||null==c.return||c.return()}finally{if(r)throw i}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function lt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var pt=function(t){var i=t.input,a=t.scene,c={dudes:lt(Array(13)).map(function(t,e){var n=new ot({arms:2236962,eyes:0===e?10027008:10066329*Math.random(),head:0===e?3355443:10066329*Math.random(),legs:2236962,torso:0===e?10027008:10066329*Math.random()});return n.position.set(Math.floor((e+1)/2)*((e+1)%2==0?1:-1),0,0),a.root.add(n),n}),walkTo:function(n){var o=n.x,r=n.z;this.dudes.forEach(function(t,e){n.x=o+Math.floor((e+1)/2)*((e+1)%2==0?1:-1),n.z=r+-1*Math.floor((e+1)/2),0<e&&(n.x+=2*Math.random()-1,n.z+=2*Math.random()-1,t.actions.walk.timeScale=.8+.4*Math.random()),t.walkTo(n)})}},e=ft(c.dudes,1)[0];e.destinationMarker=new ut,a.root.add(e.destinationMarker),a.camera.target=e.position,a.camera.distance=6,a.camera.pitch=.125*Math.PI,a.camera.updateOrbit(),a.onAnimationTick=function(){var t=a.camera,e=a.grid,n=i.getPointerFrame();if(t.processInput(n),n.primaryUp){var o=n.raycaster;o.setFromCamera(n.normalized,t);var r=o.intersectObject(e)[0];if(!r)return;c.walkTo(r.point)}}};function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function dt(t,e){return(dt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vt=function(t){var e,n,o;function p(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.hasElevator,o=void 0!==n&&n,r=e.isEdge,i=void 0!==r&&r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);var a=new y.o,c=p.generateWall({material:0,orientation:"horizontal"});if(c.translate(0,-5e-4,0),a.merge(c),o){var s=p.generateWall({width:.25,material:1});s.translate(-.375,.5,-.5),a.merge(s),s.translate(.75,0,0),a.merge(s)}else{var u=p.generateWall({material:1});u.translate(0,.5,-.5),a.merge(u)}var f=p.generateWall({height:1/3,material:1});if(f.rotateY(Math.PI),f.translate(0,1/3/2,.5),a.merge(f),i){var l=p.generateWall({height:1/3,material:1});l.rotateY(.5*Math.PI*("left"===i?1:-1)),l.translate("left"===i?-.5:.5,1/3/2,0),a.merge(l)}return(t=yt(this,mt(p).call(this,(new y.f).fromGeometry(a),[new P({side:y.l,vertexColors:y.P}),new y.s({side:y.l,vertexColors:y.P})]))).scale.copy(p.scale),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dt(t,e)}(p,y["q"]),e=p,o=[{key:"generateWall",value:function(t){var e=t.width,n=void 0===e?1:e,o=t.height,r=void 0===o?1:o,i=t.material,a=t.orientation,c=new y.w(n,r,Math.ceil(n*p.scale.x),Math.ceil(r*("horizontal"===a?p.scale.x:p.scale.y)));"horizontal"===a&&c.rotateX(-.5*Math.PI);var s=new y.i;return c.faces.forEach(function(t,e){e%2==0&&s.setHSL(Math.random(),.0125,.25+.125*Math.random()),t.materialIndex=i,t.color.copy(s)}),c}}],(n=null)&&bt(e.prototype,n),o&&bt(e,o),p}();vt.scale=new y.M(4,3,4);var wt=vt;function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ot(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jt=function(t){function u(t){var e,n=t.floors,o=t.origin;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);for(var r=new y.o,i=0;i<=n;i+=1){if(0===i||i===n){var a=new y.w(1,1);if(a.rotateX(-.5*Math.PI),a.translate(0,i,0),r.merge(a),i===n)break}var c=new y.w(1,1);c.translate(0,i+.5,-.5),r.merge(c);var s=new y.w(1,1);s.rotateY(-.5*Math.PI),s.translate(-.5,i+.5,0),r.merge(s),s.translate(1,0,0),r.merge(s)}return r.translate(0,0,-1.5),(e=Ot(this,Pt(u).call(this,(new y.f).fromGeometry(r),new y.s({color:u.color,side:y.l})))).position.x=4*o.x,e.position.y=3*o.y,e.scale.copy(u.scale),e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(u,y["q"]),u}();jt.color=3355443,jt.scale=new y.M(2,3,2);var _t=jt;function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function At(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function It(t,e){return!e||"object"!==St(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function kt(t,e){return(kt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Et=function(t){function r(t){var c,e=t.dudes,n=t.elevators,o=t.floors;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(c=It(this,xt(r).call(this))).dudes=e.map(function(t){var e=t.pallete,n=t.position,o=new ot(e);return o.position.copy(n),c.add(o),o}),c.elevators=n.map(function(t){var e=t.floors,n=t.origin,o=new _t({floors:e,origin:n});return c.add(o),{floors:e,origin:n,shaft:o}}),c.floors=o.map(function(i,a){return i.map(function(t,o){t.type;var e=!1;0===o?e="left":o===i.length-1&&(e="right");var n,r=-1!==c.elevators.findIndex(function(t){var e=t.floors,n=t.origin;return n.x===o-Math.floor(i.length/2)&&n.y<=a&&n.y+e>a});return(n=new wt({hasElevator:r,isEdge:e})).position.set(4*o-4*Math.floor(i.length/2),3*a,0),c.add(n),n})}),c}var e,n,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kt(t,e)}(r,y["t"]),e=r,(n=[{key:"onAnimationTick",value:function(e){this.dudes.forEach(function(t){return t.onAnimationTick(e)})}}])&&At(e.prototype,n),o&&At(e,o),r}();function Tt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Dt=function(t){var r=t.input,i=t.scene,a=new ot({arms:2236962,eyes:10027008,head:3355443,legs:2236962,torso:10027008});a.position.set(2,3,0),a.destinationMarker=new ut;var e=new y.M;a.onDestinationCallback=function(){i.camera.getWorldPosition(e),a.faceTo(e)},i.root.add(a),i.root.add(a.destinationMarker),i.camera.target=a.position;var c=new Et({dudes:Tt(Array(4)).map(function(){return{pallete:{arms:2236962,eyes:10066329*Math.random(),head:10066329*Math.random(),legs:2236962,torso:10066329*Math.random()},position:new y.M(2*(9*Math.random()-4.5),3*Math.floor(3*Math.random()),0)}}),elevators:[{floors:2,origin:{x:-1,y:0}},{floors:2,origin:{x:1,y:1}}],floors:[Tt(Array(5)).map(function(){return{type:"hallway"}}),Tt(Array(5)).map(function(){return{type:"hallway"}}),Tt(Array(5)).map(function(){return{type:"hallway"}}),Tt(Array(5)).map(function(){return{type:"hallway"}})]});i.root.add(c);i.onAnimationTick=function(){var t=i.camera,e=r.getPointerFrame();if(t.processInput(e)&&!a.destination&&a.onDestinationCallback(),e.primaryUp){var n=e.raycaster;n.setFromCamera(e.normalized,t);var o=n.intersectObjects(Tt(c.floors[1]))[0];if(!o)return;o.point.x=Math.min(Math.max(o.point.x,-9.5),9.5),o.point.y=o.object.position.y,o.point.z=Math.min(Math.max(o.point.z,-1.5),1.5),a.walkTo(o.point)}}},zt=document.getElementById("mount"),Ft=new s({mount:zt}),Rt=new q({mount:zt});Ft.touches.once("end",function(){document.getElementById("credits").style.display="none",Ft.isEnabled=!0});var Ct=window.location.hash.split("/").slice(1)[0];o[Ct]||(window.location.hash="/game",Ct="game"),o[Ct]({input:Ft,scene:Rt})}},[[0,1,2]]]);
//# sourceMappingURL=main.6cad86620f8ae454f5e5f4541bec071c.js.map